/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/spotify/callback/route";
exports.ids = ["app/api/auth/spotify/callback/route"];
exports.modules = {

/***/ "(rsc)/./app/api/auth/spotify/callback/route.ts":
/*!************************************************!*\
  !*** ./app/api/auth/spotify/callback/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_spotify_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/spotify-service */ \"(rsc)/./lib/services/spotify-service.ts\");\n\n\nasync function GET(request) {\n    try {\n        const url = new URL(request.url);\n        const code = url.searchParams.get('code');\n        const state = url.searchParams.get('state');\n        const error = url.searchParams.get('error');\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/auth?error=spotify_auth_failed`);\n        }\n        if (!code || !state) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/auth?error=missing_params`);\n        }\n        // Decode state to get userId\n        const stateData = JSON.parse(Buffer.from(state, 'base64').toString());\n        const { userId } = stateData;\n        if (!userId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/auth?error=invalid_state`);\n        }\n        // Handle the OAuth callback\n        await _lib_services_spotify_service__WEBPACK_IMPORTED_MODULE_1__.spotifyService.handleCallback(code, userId);\n        // Redirect back to platform connect page with success\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/platforms/connect?platforms=spotify&success=spotify_connected`);\n    } catch (error) {\n        console.error('Spotify callback error:', error);\n        // Check if it's a service role key issue\n        if (error instanceof Error && error.message.includes('Service role key not configured')) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/auth?error=service_role_key_missing`);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(`${\"https://3d686033c4c8.ngrok-free.app\"}/auth?error=callback_failed`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvc3BvdGlmeS9jYWxsYmFjay9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBdUQ7QUFDUTtBQUV4RCxlQUFlRSxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsTUFBTUMsTUFBTSxJQUFJQyxJQUFJRixRQUFRQyxHQUFHO1FBQy9CLE1BQU1FLE9BQU9GLElBQUlHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1FBQ2xDLE1BQU1DLFFBQVFMLElBQUlHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1FBQ25DLE1BQU1FLFFBQVFOLElBQUlHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1FBRW5DLElBQUlFLE9BQU87WUFDVCxPQUFPVixxREFBWUEsQ0FBQ1csUUFBUSxDQUMxQixHQUFHQyxxQ0FBK0IsQ0FBQywrQkFBK0IsQ0FBQztRQUV2RTtRQUVBLElBQUksQ0FBQ04sUUFBUSxDQUFDRyxPQUFPO1lBQ25CLE9BQU9ULHFEQUFZQSxDQUFDVyxRQUFRLENBQzFCLEdBQUdDLHFDQUErQixDQUFDLDBCQUEwQixDQUFDO1FBRWxFO1FBRUEsNkJBQTZCO1FBQzdCLE1BQU1HLFlBQVlDLEtBQUtDLEtBQUssQ0FBQ0MsT0FBT0MsSUFBSSxDQUFDVixPQUFPLFVBQVVXLFFBQVE7UUFDbEUsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBR047UUFFbkIsSUFBSSxDQUFDTSxRQUFRO1lBQ1gsT0FBT3JCLHFEQUFZQSxDQUFDVyxRQUFRLENBQzFCLEdBQUdDLHFDQUErQixDQUFDLHlCQUF5QixDQUFDO1FBRWpFO1FBRUEsNEJBQTRCO1FBQzVCLE1BQU1YLHlFQUFjQSxDQUFDcUIsY0FBYyxDQUFDaEIsTUFBTWU7UUFFMUMsc0RBQXNEO1FBQ3RELE9BQU9yQixxREFBWUEsQ0FBQ1csUUFBUSxDQUMxQixHQUFHQyxxQ0FBK0IsQ0FBQyw4REFBOEQsQ0FBQztJQUV0RyxFQUFFLE9BQU9GLE9BQU87UUFDZGEsUUFBUWIsS0FBSyxDQUFDLDJCQUEyQkE7UUFFekMseUNBQXlDO1FBQ3pDLElBQUlBLGlCQUFpQmMsU0FBU2QsTUFBTWUsT0FBTyxDQUFDQyxRQUFRLENBQUMsb0NBQW9DO1lBQ3ZGLE9BQU8xQixxREFBWUEsQ0FBQ1csUUFBUSxDQUMxQixHQUFHQyxxQ0FBK0IsQ0FBQyxvQ0FBb0MsQ0FBQztRQUU1RTtRQUVBLE9BQU9aLHFEQUFZQSxDQUFDVyxRQUFRLENBQzFCLEdBQUdDLHFDQUErQixDQUFDLDJCQUEyQixDQUFDO0lBRW5FO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9jYXJyaWV5dS9EZXNrdG9wL3Nwb3RpZnkvYXBwL2FwaS9hdXRoL3Nwb3RpZnkvY2FsbGJhY2svcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgc3BvdGlmeVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9zcG90aWZ5LXNlcnZpY2UnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICAgIGNvbnN0IGNvZGUgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnY29kZScpXG4gICAgY29uc3Qgc3RhdGUgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnc3RhdGUnKVxuICAgIGNvbnN0IGVycm9yID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2Vycm9yJylcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChcbiAgICAgICAgYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTH0vYXV0aD9lcnJvcj1zcG90aWZ5X2F1dGhfZmFpbGVkYFxuICAgICAgKVxuICAgIH1cblxuICAgIGlmICghY29kZSB8fCAhc3RhdGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QoXG4gICAgICAgIGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQUF9VUkx9L2F1dGg/ZXJyb3I9bWlzc2luZ19wYXJhbXNgXG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gRGVjb2RlIHN0YXRlIHRvIGdldCB1c2VySWRcbiAgICBjb25zdCBzdGF0ZURhdGEgPSBKU09OLnBhcnNlKEJ1ZmZlci5mcm9tKHN0YXRlLCAnYmFzZTY0JykudG9TdHJpbmcoKSlcbiAgICBjb25zdCB7IHVzZXJJZCB9ID0gc3RhdGVEYXRhXG5cbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChcbiAgICAgICAgYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTH0vYXV0aD9lcnJvcj1pbnZhbGlkX3N0YXRlYFxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgT0F1dGggY2FsbGJhY2tcbiAgICBhd2FpdCBzcG90aWZ5U2VydmljZS5oYW5kbGVDYWxsYmFjayhjb2RlLCB1c2VySWQpXG5cbiAgICAvLyBSZWRpcmVjdCBiYWNrIHRvIHBsYXRmb3JtIGNvbm5lY3QgcGFnZSB3aXRoIHN1Y2Nlc3NcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTH0vcGxhdGZvcm1zL2Nvbm5lY3Q/cGxhdGZvcm1zPXNwb3RpZnkmc3VjY2Vzcz1zcG90aWZ5X2Nvbm5lY3RlZGBcbiAgICApXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU3BvdGlmeSBjYWxsYmFjayBlcnJvcjonLCBlcnJvcilcbiAgICBcbiAgICAvLyBDaGVjayBpZiBpdCdzIGEgc2VydmljZSByb2xlIGtleSBpc3N1ZVxuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1NlcnZpY2Ugcm9sZSBrZXkgbm90IGNvbmZpZ3VyZWQnKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChcbiAgICAgICAgYCR7cHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBQX1VSTH0vYXV0aD9lcnJvcj1zZXJ2aWNlX3JvbGVfa2V5X21pc3NpbmdgXG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QoXG4gICAgICBgJHtwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUFBfVVJMfS9hdXRoP2Vycm9yPWNhbGxiYWNrX2ZhaWxlZGBcbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJzcG90aWZ5U2VydmljZSIsIkdFVCIsInJlcXVlc3QiLCJ1cmwiLCJVUkwiLCJjb2RlIiwic2VhcmNoUGFyYW1zIiwiZ2V0Iiwic3RhdGUiLCJlcnJvciIsInJlZGlyZWN0IiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJzdGF0ZURhdGEiLCJKU09OIiwicGFyc2UiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJ1c2VySWQiLCJoYW5kbGVDYWxsYmFjayIsImNvbnNvbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJpbmNsdWRlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/spotify/callback/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/spotify-service.ts":
/*!*****************************************!*\
  !*** ./lib/services/spotify-service.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SpotifyService: () => (/* binding */ SpotifyService),\n/* harmony export */   spotifyService: () => (/* binding */ spotifyService)\n/* harmony export */ });\n/* harmony import */ var spotify_web_api_node__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! spotify-web-api-node */ \"(rsc)/./node_modules/spotify-web-api-node/src/server.js\");\n/* harmony import */ var spotify_web_api_node__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(spotify_web_api_node__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/service */ \"(rsc)/./lib/supabase/service.ts\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\n\n\nclass SpotifyService {\n    constructor(){\n        this.accessToken = null;\n        this.refreshToken = null;\n        this.expiresAt = null;\n        this.spotifyApi = new (spotify_web_api_node__WEBPACK_IMPORTED_MODULE_0___default())({\n            clientId: process.env.SPOTIFY_CLIENT_ID,\n            clientSecret: process.env.SPOTIFY_CLIENT_SECRET,\n            redirectUri: `${\"https://3d686033c4c8.ngrok-free.app\"}/api/auth/spotify/callback`\n        });\n    }\n    // Initialize with user tokens\n    async initialize(userId) {\n        try {\n            const userServices = await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.getUserServices(userId);\n            const spotifyService = userServices.find((s)=>s.service_id === 'spotify');\n            if (!spotifyService || !spotifyService.access_token) {\n                return false;\n            }\n            this.accessToken = spotifyService.access_token;\n            this.refreshToken = spotifyService.refresh_token;\n            this.expiresAt = spotifyService.expires_at ? new Date(spotifyService.expires_at).getTime() : null;\n            this.spotifyApi.setAccessToken(this.accessToken);\n            // Refresh token if expired\n            if (this.expiresAt && Date.now() >= this.expiresAt) {\n                await this.refreshAccessToken(userId);\n            }\n            return true;\n        } catch (error) {\n            console.error('Failed to initialize Spotify service:', error);\n            return false;\n        }\n    }\n    // Refresh access token\n    async refreshAccessToken(userId) {\n        if (!this.refreshToken) throw new Error('No refresh token available');\n        try {\n            this.spotifyApi.setRefreshToken(this.refreshToken);\n            const { body } = await this.spotifyApi.refreshAccessToken();\n            this.accessToken = body.access_token;\n            this.expiresAt = Date.now() + body.expires_in * 1000;\n            this.spotifyApi.setAccessToken(this.accessToken);\n            // Update tokens in database\n            await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.connectService({\n                user_id: userId,\n                service_id: 'spotify',\n                access_token: this.accessToken,\n                refresh_token: this.refreshToken,\n                expires_at: new Date(this.expiresAt).toISOString(),\n                is_active: true\n            });\n        } catch (error) {\n            console.error('Failed to refresh Spotify access token:', error);\n            throw error;\n        }\n    }\n    // Get authorization URL for OAuth\n    getAuthorizationUrl(state) {\n        const scopes = [\n            'user-read-private',\n            'user-read-email',\n            'user-library-read',\n            'user-library-modify',\n            'playlist-read-private',\n            'playlist-read-collaborative',\n            'playlist-modify-public',\n            'playlist-modify-private',\n            'user-read-playback-state',\n            'user-modify-playback-state',\n            'user-read-currently-playing',\n            'user-read-recently-played',\n            'user-top-read',\n            'streaming'\n        ];\n        return this.spotifyApi.createAuthorizeURL(scopes, state || 'state');\n    }\n    // Handle OAuth callback\n    async handleCallback(code, userId) {\n        try {\n            const { body } = await this.spotifyApi.authorizationCodeGrant(code);\n            this.accessToken = body.access_token;\n            this.refreshToken = body.refresh_token;\n            this.expiresAt = Date.now() + body.expires_in * 1000;\n            // Get user profile\n            this.spotifyApi.setAccessToken(this.accessToken);\n            const { body: profile } = await this.spotifyApi.getMe();\n            // Save to database using server-side service (bypasses RLS)\n            await _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.supabaseServerService.connectService({\n                user_id: userId,\n                service_id: 'spotify',\n                access_token: this.accessToken,\n                refresh_token: this.refreshToken,\n                expires_at: new Date(this.expiresAt).toISOString(),\n                is_active: true,\n                service_user_id: profile.id,\n                service_username: profile.display_name || profile.id\n            });\n        } catch (error) {\n            console.error('Failed to handle Spotify callback:', error);\n            throw error;\n        }\n    }\n    // Search tracks\n    async searchTracks(query, limit = 20) {\n        try {\n            const { body } = await this.spotifyApi.searchTracks(query, {\n                limit\n            });\n            return await Promise.all(body.tracks?.items.map((track)=>this.mapSpotifyTrack(track)) || []);\n        } catch (error) {\n            console.error('Failed to search Spotify tracks:', error);\n            return [];\n        }\n    }\n    // Get user's saved tracks\n    async getLikedTracks(limit = 50, offset = 0) {\n        try {\n            const { body } = await this.spotifyApi.getMySavedTracks({\n                limit,\n                offset\n            });\n            return await Promise.all(body.items.map((item)=>this.mapSpotifyTrack(item.track)));\n        } catch (error) {\n            console.error('Failed to get liked tracks:', error);\n            return [];\n        }\n    }\n    // Get user's playlists\n    async getUserPlaylists(limit = 50, offset = 0) {\n        try {\n            const { body } = await this.spotifyApi.getUserPlaylists({\n                limit,\n                offset\n            });\n            return await Promise.all(body.items.map((playlist)=>this.mapSpotifyPlaylist(playlist)));\n        } catch (error) {\n            console.error('Failed to get user playlists:', error);\n            return [];\n        }\n    }\n    // Get playlist tracks\n    async getPlaylistTracks(playlistId) {\n        try {\n            const { body } = await this.spotifyApi.getPlaylistTracks(playlistId);\n            return await Promise.all(body.items.filter((item)=>item.track).map((item)=>this.mapSpotifyTrack(item.track)));\n        } catch (error) {\n            console.error('Failed to get playlist tracks:', error);\n            return [];\n        }\n    }\n    // Get user's top tracks\n    async getTopTracks(limit = 20) {\n        try {\n            const { body } = await this.spotifyApi.getMyTopTracks({\n                limit\n            });\n            return await Promise.all(body.items.map((track)=>this.mapSpotifyTrack(track)));\n        } catch (error) {\n            console.error('Failed to get top tracks:', error);\n            return [];\n        }\n    }\n    // Get recently played tracks\n    async getRecentlyPlayed(limit = 20) {\n        try {\n            const { body } = await this.spotifyApi.getMyRecentlyPlayedTracks({\n                limit\n            });\n            return await Promise.all(body.items.map((item)=>this.mapSpotifyTrack(item.track)));\n        } catch (error) {\n            console.error('Failed to get recently played tracks:', error);\n            return [];\n        }\n    }\n    // Get recommendations\n    async getRecommendations(seedTracks, seedArtists, seedGenres, limit = 20) {\n        try {\n            const { body } = await this.spotifyApi.getRecommendations({\n                seed_tracks: seedTracks?.slice(0, 5),\n                seed_artists: seedArtists?.slice(0, 5),\n                seed_genres: seedGenres?.slice(0, 5),\n                limit\n            });\n            return await Promise.all(body.tracks.map((track)=>this.mapSpotifyTrack(track)));\n        } catch (error) {\n            console.error('Failed to get recommendations:', error);\n            return [];\n        }\n    }\n    // Get track details\n    async getTrack(trackId) {\n        try {\n            const { body } = await this.spotifyApi.getTrack(trackId);\n            return await this.mapSpotifyTrack(body);\n        } catch (error) {\n            console.error('Failed to get track:', error);\n            return null;\n        }\n    }\n    // Get album details\n    async getAlbum(albumId) {\n        try {\n            const { body } = await this.spotifyApi.getAlbum(albumId);\n            return await this.mapSpotifyAlbum(body);\n        } catch (error) {\n            console.error('Failed to get album:', error);\n            return null;\n        }\n    }\n    // Get artist details\n    async getArtist(artistId) {\n        try {\n            const { body } = await this.spotifyApi.getArtist(artistId);\n            return await this.mapSpotifyArtist(body);\n        } catch (error) {\n            console.error('Failed to get artist:', error);\n            return null;\n        }\n    }\n    // Map Spotify track to unified format\n    async mapSpotifyTrack(track) {\n        try {\n            // Check if track exists in our database\n            let supabaseTrack = await this.findOrCreateTrack(track);\n            return {\n                id: supabaseTrack.id,\n                title: track.name,\n                artist: await this.mapSpotifyArtist(track.artists[0]),\n                album: await this.mapSpotifyAlbum(track.album),\n                duration: track.duration_ms / 1000,\n                streamUrl: `spotify:track:${track.id}`,\n                previewUrl: track.preview_url || undefined,\n                isLiked: false,\n                playCount: 0,\n                artwork: track.album.images && track.album.images.length > 0 ? track.album.images[0].url : '',\n                genres: [],\n                releaseDate: track.album.release_date,\n                serviceId: 'spotify',\n                originalId: track.id,\n                availableServices: [\n                    'spotify'\n                ],\n                quality: 'high'\n            };\n        } catch (error) {\n            console.error('Error mapping Spotify track:', error);\n            // Return a minimal track object\n            return {\n                id: track.id,\n                title: track.name,\n                artist: {\n                    id: track.artists[0]?.id || 'unknown',\n                    name: track.artists[0]?.name || 'Unknown Artist',\n                    image: '',\n                    followers: 0,\n                    isFollowed: false,\n                    genres: [],\n                    serviceId: 'spotify',\n                    originalId: track.artists[0]?.id || 'unknown',\n                    availableServices: [\n                        'spotify'\n                    ]\n                },\n                album: {\n                    id: track.album?.id || 'unknown',\n                    title: track.album?.name || 'Unknown Album',\n                    artist: {\n                        id: track.artists[0]?.id || 'unknown',\n                        name: track.artists[0]?.name || 'Unknown Artist',\n                        image: '',\n                        followers: 0,\n                        isFollowed: false,\n                        genres: [],\n                        serviceId: 'spotify',\n                        originalId: track.artists[0]?.id || 'unknown',\n                        availableServices: [\n                            'spotify'\n                        ]\n                    },\n                    artwork: track.album?.images && track.album.images.length > 0 ? track.album.images[0].url : '',\n                    releaseDate: track.album?.release_date || '',\n                    tracks: [],\n                    totalTracks: track.album?.total_tracks || 0,\n                    duration: 0,\n                    genres: [],\n                    type: 'album',\n                    serviceId: 'spotify',\n                    originalId: track.album?.id || 'unknown',\n                    availableServices: [\n                        'spotify'\n                    ]\n                },\n                duration: track.duration_ms / 1000,\n                streamUrl: `spotify:track:${track.id}`,\n                previewUrl: track.preview_url || undefined,\n                isLiked: false,\n                playCount: 0,\n                artwork: track.album?.images && track.album.images.length > 0 ? track.album.images[0].url : '',\n                genres: [],\n                releaseDate: track.album?.release_date || '',\n                serviceId: 'spotify',\n                originalId: track.id,\n                availableServices: [\n                    'spotify'\n                ],\n                quality: 'high'\n            };\n        }\n    }\n    // Map Spotify artist to unified format\n    async mapSpotifyArtist(artist) {\n        // Check if artist exists in our database\n        let supabaseArtist = await this.findOrCreateArtist(artist);\n        return {\n            id: supabaseArtist.id,\n            name: artist.name,\n            image: artist.images[0]?.url || '',\n            followers: artist.followers?.total || 0,\n            isFollowed: false,\n            genres: artist.genres || [],\n            bio: undefined,\n            serviceId: 'spotify',\n            originalId: artist.id,\n            availableServices: [\n                'spotify'\n            ]\n        };\n    }\n    // Map Spotify album to unified format\n    async mapSpotifyAlbum(album) {\n        // Check if album exists in our database\n        let supabaseAlbum = await this.findOrCreateAlbum(album);\n        return {\n            id: supabaseAlbum.id,\n            title: album.name,\n            artist: await this.mapSpotifyArtist(album.artists[0]),\n            artwork: album.images[0]?.url || '',\n            releaseDate: album.release_date,\n            tracks: [],\n            totalTracks: album.total_tracks,\n            duration: 0,\n            genres: album.genres || [],\n            type: album.album_type,\n            serviceId: 'spotify',\n            originalId: album.id,\n            availableServices: [\n                'spotify'\n            ]\n        };\n    }\n    // Map Spotify playlist to unified format\n    async mapSpotifyPlaylist(playlist) {\n        return {\n            id: playlist.id,\n            title: playlist.name,\n            description: playlist.description || undefined,\n            creator: {\n                id: playlist.owner.id,\n                name: playlist.owner.display_name || playlist.owner.id,\n                image: undefined\n            },\n            tracks: [],\n            artwork: playlist.images[0]?.url || '',\n            isPublic: playlist.public,\n            isLiked: false,\n            followers: playlist.followers?.total || 0,\n            createdAt: playlist.created_at,\n            updatedAt: new Date().toISOString(),\n            serviceId: 'spotify',\n            originalId: playlist.id,\n            availableServices: [\n                'spotify'\n            ]\n        };\n    }\n    // Find or create track in database\n    async findOrCreateTrack(track) {\n        try {\n            // First try to find by ISRC\n            if (track.external_ids?.isrc) {\n                const existingTrack = await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.searchTracks(track.external_ids.isrc, 1);\n                if (existingTrack.length > 0) {\n                    return existingTrack[0];\n                }\n            }\n            // Create new track\n            const artist = await this.findOrCreateArtist(track.artists[0]);\n            const album = await this.findOrCreateAlbum(track.album);\n            const newTrack = await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.createTrack({\n                title: track.name,\n                artist_id: artist.id,\n                album_id: album.id,\n                duration: Math.floor(track.duration_ms / 1000),\n                track_number: track.track_number,\n                disc_number: track.disc_number,\n                isrc: track.external_ids?.isrc || null,\n                external_url: track.external_urls?.spotify || null\n            });\n            // Add Spotify service mapping\n            await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.addTrackService({\n                track_id: newTrack.id,\n                service_id: 'spotify',\n                service_track_id: track.id,\n                stream_url: `spotify:track:${track.id}`,\n                preview_url: track.preview_url || null,\n                quality: 'high',\n                is_available: true\n            });\n            return newTrack;\n        } catch (error) {\n            console.error('Error creating track:', error);\n            // Return a mock track object if database creation fails\n            return {\n                id: `mock-track-${track.id}`,\n                title: track.name,\n                artist_id: `mock-${track.artists[0].id}`,\n                album_id: `mock-album-${track.album.id}`,\n                duration: Math.floor(track.duration_ms / 1000),\n                track_number: track.track_number,\n                disc_number: track.disc_number,\n                isrc: track.external_ids?.isrc || null,\n                external_url: track.external_urls?.spotify || null,\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            };\n        }\n    }\n    // Find or create artist in database\n    async findOrCreateArtist(artist) {\n        try {\n            const existingArtists = await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.searchArtists(artist.name, 1);\n            if (existingArtists.length > 0) {\n                return existingArtists[0];\n            }\n            return await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.createArtist({\n                name: artist.name,\n                image_url: artist.images && artist.images.length > 0 ? artist.images[0].url : null,\n                bio: null,\n                genres: artist.genres || [],\n                external_url: artist.external_urls?.spotify || null\n            });\n        } catch (error) {\n            console.error('Error mapping Spotify track:', error);\n            // Return a mock artist object if database creation fails\n            return {\n                id: `mock-${artist.id}`,\n                name: artist.name,\n                image_url: artist.images && artist.images.length > 0 ? artist.images[0].url : null,\n                bio: null,\n                genres: artist.genres || [],\n                external_url: artist.external_urls?.spotify || null,\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            };\n        }\n    }\n    // Find or create album in database\n    async findOrCreateAlbum(album) {\n        try {\n            const existingAlbums = await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.searchAlbums(album.name, 1);\n            if (existingAlbums.length > 0) {\n                return existingAlbums[0];\n            }\n            const artist = await this.findOrCreateArtist(album.artists[0]);\n            return await _lib_supabase_service__WEBPACK_IMPORTED_MODULE_1__.supabaseService.createAlbum({\n                title: album.name,\n                artist_id: artist.id,\n                artwork_url: album.images && album.images.length > 0 ? album.images[0].url : null,\n                release_date: album.release_date,\n                total_tracks: album.total_tracks,\n                duration: 0,\n                genres: album.genres || [],\n                album_type: album.album_type,\n                external_url: album.external_urls?.spotify || null\n            });\n        } catch (error) {\n            console.error('Error creating album:', error);\n            // Return a mock album object if database creation fails\n            return {\n                id: `mock-album-${album.id}`,\n                title: album.name,\n                artist_id: `mock-${album.artists[0].id}`,\n                artwork_url: album.images && album.images.length > 0 ? album.images[0].url : null,\n                release_date: album.release_date,\n                total_tracks: album.total_tracks,\n                duration: 0,\n                genres: album.genres || [],\n                album_type: album.album_type,\n                external_url: album.external_urls?.spotify || null,\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            };\n        }\n    }\n    // Add track service mapping (helper method)\n    async addTrackService(trackService) {\n        // This would be implemented in the SupabaseService\n        // For now, we'll use the direct Supabase client\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\"));\n        const supabase = await createClient();\n        await supabase.from('track_services').insert(trackService);\n    }\n    // Helper methods for SupabaseService (these would be added to the service)\n    async createTrack(trackData) {\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\"));\n        const supabase = await createClient();\n        const { data, error } = await supabase.from('tracks').insert(trackData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async createArtist(artistData) {\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\"));\n        const supabase = await createClient();\n        const { data, error } = await supabase.from('artists').insert(artistData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async createAlbum(albumData) {\n        const { createClient } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\"));\n        const supabase = await createClient();\n        const { data, error } = await supabase.from('albums').insert(albumData).select().single();\n        if (error) throw error;\n        return data;\n    }\n}\n// Export singleton instance\nconst spotifyService = new SpotifyService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2VydmljZXMvc3BvdGlmeS1zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFnRDtBQUNRO0FBQ0s7QUErRXRELE1BQU1HO0lBTVgsYUFBYzthQUpOQyxjQUE2QjthQUM3QkMsZUFBOEI7YUFDOUJDLFlBQTJCO1FBR2pDLElBQUksQ0FBQ0MsVUFBVSxHQUFHLElBQUlQLDZEQUFhQSxDQUFDO1lBQ2xDUSxVQUFVQyxRQUFRQyxHQUFHLENBQUNDLGlCQUFpQjtZQUN2Q0MsY0FBY0gsUUFBUUMsR0FBRyxDQUFDRyxxQkFBcUI7WUFDL0NDLGFBQWEsR0FBR0wscUNBQStCLENBQUMsMEJBQTBCLENBQUM7UUFDN0U7SUFDRjtJQUVBLDhCQUE4QjtJQUM5QixNQUFNTyxXQUFXQyxNQUFjLEVBQW9CO1FBQ2pELElBQUk7WUFDRixNQUFNQyxlQUFlLE1BQU1qQixrRUFBZUEsQ0FBQ2tCLGVBQWUsQ0FBQ0Y7WUFDM0QsTUFBTUcsaUJBQWlCRixhQUFhRyxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLFVBQVUsS0FBSztZQUUvRCxJQUFJLENBQUNILGtCQUFrQixDQUFDQSxlQUFlSSxZQUFZLEVBQUU7Z0JBQ25ELE9BQU87WUFDVDtZQUVBLElBQUksQ0FBQ3BCLFdBQVcsR0FBR2dCLGVBQWVJLFlBQVk7WUFDOUMsSUFBSSxDQUFDbkIsWUFBWSxHQUFHZSxlQUFlSyxhQUFhO1lBQ2hELElBQUksQ0FBQ25CLFNBQVMsR0FBR2MsZUFBZU0sVUFBVSxHQUFHLElBQUlDLEtBQUtQLGVBQWVNLFVBQVUsRUFBRUUsT0FBTyxLQUFLO1lBRTdGLElBQUksQ0FBQ3JCLFVBQVUsQ0FBQ3NCLGNBQWMsQ0FBQyxJQUFJLENBQUN6QixXQUFXO1lBRS9DLDJCQUEyQjtZQUMzQixJQUFJLElBQUksQ0FBQ0UsU0FBUyxJQUFJcUIsS0FBS0csR0FBRyxNQUFNLElBQUksQ0FBQ3hCLFNBQVMsRUFBRTtnQkFDbEQsTUFBTSxJQUFJLENBQUN5QixrQkFBa0IsQ0FB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QUFNLENBQUNDLFdBQ1BFLE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlsSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9nSjtJQUNUO0lBRUEsTUFBY1osYUFBYWUsVUFBZSxFQUEyQjtRQUNuRSxNQUFNLEVBQUVSLFlBQVksRUFBRSxHQUFHLE1BQU0sbUpBQStCO1FBQzlELE1BQU1DLFdBQVcsTUFBTUQ7UUFFdkIsTUFBTSxFQUFFSyxJQUFJLEVBQUVoSixLQUFLLEVBQUUsR0FBRyxNQUFNNEksU0FDM0JDLElBQUksQ0FBQyxXQUNMQyxNQUFNLENBQUNLLFlBQ1BGLE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlsSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9nSjtJQUNUO0lBRUEsTUFBY1IsWUFBWVksU0FBYyxFQUEwQjtRQUNoRSxNQUFNLEVBQUVULFlBQVksRUFBRSxHQUFHLE1BQU0sbUpBQStCO1FBQzlELE1BQU1DLFdBQVcsTUFBTUQ7UUFFdkIsTUFBTSxFQUFFSyxJQUFJLEVBQUVoSixLQUFLLEVBQUUsR0FBRyxNQUFNNEksU0FDM0JDLElBQUksQ0FBQyxVQUNMQyxNQUFNLENBQUNNLFdBQ1BILE1BQU0sR0FDTkMsTUFBTTtRQUVULElBQUlsSixPQUFPLE1BQU1BO1FBQ2pCLE9BQU9nSjtJQUNUO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTTVKLGlCQUFpQixJQUFJakIsaUJBQWdCIiwic291cmNlcyI6WyIvVXNlcnMvY2FycmlleXUvRGVza3RvcC9zcG90aWZ5L2xpYi9zZXJ2aWNlcy9zcG90aWZ5LXNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNwb3RpZnlXZWJBcGkgZnJvbSAnc3BvdGlmeS13ZWItYXBpLW5vZGUnXG5pbXBvcnQgeyBzdXBhYmFzZVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2aWNlJ1xuaW1wb3J0IHsgc3VwYWJhc2VTZXJ2ZXJTZXJ2aWNlIH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJ1xuaW1wb3J0IHR5cGUgeyBcbiAgVHJhY2sgYXMgU3VwYWJhc2VUcmFjayxcbiAgQWxidW0gYXMgU3VwYWJhc2VBbGJ1bSxcbiAgQXJ0aXN0IGFzIFN1cGFiYXNlQXJ0aXN0LFxuICBUcmFja1NlcnZpY2UgYXMgU3VwYWJhc2VUcmFja1NlcnZpY2UsXG4gIE11c2ljU2VydmljZSBcbn0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmljZSdcblxuLy8gVW5pZmllZCBpbnRlcmZhY2VzIGZvciBjcm9zcy1zZXJ2aWNlIGNvbXBhdGliaWxpdHlcbmV4cG9ydCBpbnRlcmZhY2UgU3BvdGlmeVRyYWNrIHtcbiAgaWQ6IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIGFydGlzdDogU3BvdGlmeUFydGlzdFxuICBhbGJ1bTogU3BvdGlmeUFsYnVtXG4gIGR1cmF0aW9uOiBudW1iZXJcbiAgc3RyZWFtVXJsPzogc3RyaW5nXG4gIHByZXZpZXdVcmw/OiBzdHJpbmdcbiAgaXNMaWtlZDogYm9vbGVhblxuICBwbGF5Q291bnQ6IG51bWJlclxuICBhcnR3b3JrOiBzdHJpbmdcbiAgZ2VucmVzOiBzdHJpbmdbXVxuICByZWxlYXNlRGF0ZTogc3RyaW5nXG4gIHNlcnZpY2VJZDogJ3Nwb3RpZnknXG4gIG9yaWdpbmFsSWQ6IHN0cmluZ1xuICBhdmFpbGFibGVTZXJ2aWNlczogTXVzaWNTZXJ2aWNlW11cbiAgcXVhbGl0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdsb3NzbGVzcydcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTcG90aWZ5QXJ0aXN0IHtcbiAgaWQ6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgaW1hZ2U6IHN0cmluZ1xuICBmb2xsb3dlcnM6IG51bWJlclxuICBpc0ZvbGxvd2VkOiBib29sZWFuXG4gIGdlbnJlczogc3RyaW5nW11cbiAgYmlvPzogc3RyaW5nXG4gIHNlcnZpY2VJZDogJ3Nwb3RpZnknXG4gIG9yaWdpbmFsSWQ6IHN0cmluZ1xuICBhdmFpbGFibGVTZXJ2aWNlczogTXVzaWNTZXJ2aWNlW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTcG90aWZ5QWxidW0ge1xuICBpZDogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgYXJ0aXN0OiBTcG90aWZ5QXJ0aXN0XG4gIGFydHdvcms6IHN0cmluZ1xuICByZWxlYXNlRGF0ZTogc3RyaW5nXG4gIHRyYWNrczogU3BvdGlmeVRyYWNrW11cbiAgdG90YWxUcmFja3M6IG51bWJlclxuICBkdXJhdGlvbjogbnVtYmVyXG4gIGdlbnJlczogc3RyaW5nW11cbiAgdHlwZTogJ2FsYnVtJyB8ICdzaW5nbGUnIHwgJ2VwJ1xuICBzZXJ2aWNlSWQ6ICdzcG90aWZ5J1xuICBvcmlnaW5hbElkOiBzdHJpbmdcbiAgYXZhaWxhYmxlU2VydmljZXM6IE11c2ljU2VydmljZVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3BvdGlmeVBsYXlsaXN0IHtcbiAgaWQ6IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gIGNyZWF0b3I6IHtcbiAgICBpZDogc3RyaW5nXG4gICAgbmFtZTogc3RyaW5nXG4gICAgaW1hZ2U/OiBzdHJpbmdcbiAgfVxuICB0cmFja3M6IFNwb3RpZnlUcmFja1tdXG4gIGFydHdvcms6IHN0cmluZ1xuICBpc1B1YmxpYzogYm9vbGVhblxuICBpc0xpa2VkOiBib29sZWFuXG4gIGZvbGxvd2VyczogbnVtYmVyXG4gIGNyZWF0ZWRBdDogc3RyaW5nXG4gIHVwZGF0ZWRBdDogc3RyaW5nXG4gIHNlcnZpY2VJZDogJ3Nwb3RpZnknXG4gIG9yaWdpbmFsSWQ6IHN0cmluZ1xuICBhdmFpbGFibGVTZXJ2aWNlczogTXVzaWNTZXJ2aWNlW11cbn1cblxuZXhwb3J0IGNsYXNzIFNwb3RpZnlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzcG90aWZ5QXBpOiBTcG90aWZ5V2ViQXBpXG4gIHByaXZhdGUgYWNjZXNzVG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsXG4gIHByaXZhdGUgcmVmcmVzaFRva2VuOiBzdHJpbmcgfCBudWxsID0gbnVsbFxuICBwcml2YXRlIGV4cGlyZXNBdDogbnVtYmVyIHwgbnVsbCA9IG51bGxcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnNwb3RpZnlBcGkgPSBuZXcgU3BvdGlmeVdlYkFwaSh7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuU1BPVElGWV9DTElFTlRfSUQhLFxuICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5TUE9USUZZX0NMSUVOVF9TRUNSRVQhLFxuICAgICAgcmVkaXJlY3RVcmk6IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQUF9VUkx9L2FwaS9hdXRoL3Nwb3RpZnkvY2FsbGJhY2tgLFxuICAgIH0pXG4gIH1cblxuICAvLyBJbml0aWFsaXplIHdpdGggdXNlciB0b2tlbnNcbiAgYXN5bmMgaW5pdGlhbGl6ZSh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyU2VydmljZXMgPSBhd2FpdCBzdXBhYmFzZVNlcnZpY2UuZ2V0VXNlclNlcnZpY2VzKHVzZXJJZClcbiAgICAgIGNvbnN0IHNwb3RpZnlTZXJ2aWNlID0gdXNlclNlcnZpY2VzLmZpbmQocyA9PiBzLnNlcnZpY2VfaWQgPT09ICdzcG90aWZ5JylcbiAgICAgIFxuICAgICAgaWYgKCFzcG90aWZ5U2VydmljZSB8fCAhc3BvdGlmeVNlcnZpY2UuYWNjZXNzX3Rva2VuKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuXG4gICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gc3BvdGlmeVNlcnZpY2UuYWNjZXNzX3Rva2VuXG4gICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IHNwb3RpZnlTZXJ2aWNlLnJlZnJlc2hfdG9rZW5cbiAgICAgIHRoaXMuZXhwaXJlc0F0ID0gc3BvdGlmeVNlcnZpY2UuZXhwaXJlc19hdCA/IG5ldyBEYXRlKHNwb3RpZnlTZXJ2aWNlLmV4cGlyZXNfYXQpLmdldFRpbWUoKSA6IG51bGxcblxuICAgICAgdGhpcy5zcG90aWZ5QXBpLnNldEFjY2Vzc1Rva2VuKHRoaXMuYWNjZXNzVG9rZW4pXG4gICAgICBcbiAgICAgIC8vIFJlZnJlc2ggdG9rZW4gaWYgZXhwaXJlZFxuICAgICAgaWYgKHRoaXMuZXhwaXJlc0F0ICYmIERhdGUubm93KCkgPj0gdGhpcy5leHBpcmVzQXQpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoQWNjZXNzVG9rZW4odXNlcklkKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBTcG90aWZ5IHNlcnZpY2U6JywgZXJyb3IpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvLyBSZWZyZXNoIGFjY2VzcyB0b2tlblxuICBwcml2YXRlIGFzeW5jIHJlZnJlc2hBY2Nlc3NUb2tlbih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5yZWZyZXNoVG9rZW4pIHRocm93IG5ldyBFcnJvcignTm8gcmVmcmVzaCB0b2tlbiBhdmFpbGFibGUnKVxuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3BvdGlmeUFwaS5zZXRSZWZyZXNoVG9rZW4odGhpcy5yZWZyZXNoVG9rZW4pXG4gICAgICBjb25zdCB7IGJvZHkgfSA9IGF3YWl0IHRoaXMuc3BvdGlmeUFwaS5yZWZyZXNoQWNjZXNzVG9rZW4oKVxuICAgICAgXG4gICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYm9keS5hY2Nlc3NfdG9rZW5cbiAgICAgIHRoaXMuZXhwaXJlc0F0ID0gRGF0ZS5ub3coKSArIChib2R5LmV4cGlyZXNfaW4gKiAxMDAwKVxuICAgICAgXG4gICAgICB0aGlzLnNwb3RpZnlBcGkuc2V0QWNjZXNzVG9rZW4odGhpcy5hY2Nlc3NUb2tlbilcblxuICAgICAgLy8gVXBkYXRlIHRva2VucyBpbiBkYXRhYmFzZVxuICAgICAgYXdhaXQgc3VwYWJhc2VTZXJ2aWNlLmNvbm5lY3RTZXJ2aWNlKHtcbiAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICBzZXJ2aWNlX2lkOiAnc3BvdGlmeScsXG4gICAgICAgIGFjY2Vzc190b2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaF90b2tlbjogdGhpcy5yZWZyZXNoVG9rZW4sXG4gICAgICAgIGV4cGlyZXNfYXQ6IG5ldyBEYXRlKHRoaXMuZXhwaXJlc0F0KS50b0lTT1N0cmluZygpLFxuICAgICAgICBpc19hY3RpdmU6IHRydWUsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCBTcG90aWZ5IGFjY2VzcyB0b2tlbjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGF1dGhvcml6YXRpb24gVVJMIGZvciBPQXV0aFxuICBnZXRBdXRob3JpemF0aW9uVXJsKHN0YXRlPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBzY29wZXMgPSBbXG4gICAgICAndXNlci1yZWFkLXByaXZhdGUnLFxuICAgICAgJ3VzZXItcmVhZC1lbWFpbCcsXG4gICAgICAndXNlci1saWJyYXJ5LXJlYWQnLFxuICAgICAgJ3VzZXItbGlicmFyeS1tb2RpZnknLFxuICAgICAgJ3BsYXlsaXN0LXJlYWQtcHJpdmF0ZScsXG4gICAgICAncGxheWxpc3QtcmVhZC1jb2xsYWJvcmF0aXZlJyxcbiAgICAgICdwbGF5bGlzdC1tb2RpZnktcHVibGljJyxcbiAgICAgICdwbGF5bGlzdC1tb2RpZnktcHJpdmF0ZScsXG4gICAgICAndXNlci1yZWFkLXBsYXliYWNrLXN0YXRlJyxcbiAgICAgICd1c2VyLW1vZGlmeS1wbGF5YmFjay1zdGF0ZScsXG4gICAgICAndXNlci1yZWFkLWN1cnJlbnRseS1wbGF5aW5nJyxcbiAgICAgICd1c2VyLXJlYWQtcmVjZW50bHktcGxheWVkJyxcbiAgICAgICd1c2VyLXRvcC1yZWFkJyxcbiAgICAgICdzdHJlYW1pbmcnLFxuICAgIF1cblxuICAgIHJldHVybiB0aGlzLnNwb3RpZnlBcGkuY3JlYXRlQXV0aG9yaXplVVJMKHNjb3Blcywgc3RhdGUgfHwgJ3N0YXRlJylcbiAgfVxuXG4gIC8vIEhhbmRsZSBPQXV0aCBjYWxsYmFja1xuICBhc3luYyBoYW5kbGVDYWxsYmFjayhjb2RlOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYm9keSB9ID0gYXdhaXQgdGhpcy5zcG90aWZ5QXBpLmF1dGhvcml6YXRpb25Db2RlR3JhbnQoY29kZSlcbiAgICAgIFxuICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGJvZHkuYWNjZXNzX3Rva2VuXG4gICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IGJvZHkucmVmcmVzaF90b2tlblxuICAgICAgdGhpcy5leHBpcmVzQXQgPSBEYXRlLm5vdygpICsgKGJvZHkuZXhwaXJlc19pbiAqIDEwMDApXG5cbiAgICAgIC8vIEdldCB1c2VyIHByb2ZpbGVcbiAgICAgIHRoaXMuc3BvdGlmeUFwaS5zZXRBY2Nlc3NUb2tlbih0aGlzLmFjY2Vzc1Rva2VuKVxuICAgICAgY29uc3QgeyBib2R5OiBwcm9maWxlIH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0TWUoKVxuXG4gICAgICAvLyBTYXZlIHRvIGRhdGFiYXNlIHVzaW5nIHNlcnZlci1zaWRlIHNlcnZpY2UgKGJ5cGFzc2VzIFJMUylcbiAgICAgIGF3YWl0IHN1cGFiYXNlU2VydmVyU2VydmljZS5jb25uZWN0U2VydmljZSh7XG4gICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgc2VydmljZV9pZDogJ3Nwb3RpZnknLFxuICAgICAgICBhY2Nlc3NfdG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXG4gICAgICAgIHJlZnJlc2hfdG9rZW46IHRoaXMucmVmcmVzaFRva2VuLFxuICAgICAgICBleHBpcmVzX2F0OiBuZXcgRGF0ZSh0aGlzLmV4cGlyZXNBdCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgaXNfYWN0aXZlOiB0cnVlLFxuICAgICAgICBzZXJ2aWNlX3VzZXJfaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgIHNlcnZpY2VfdXNlcm5hbWU6IHByb2ZpbGUuZGlzcGxheV9uYW1lIHx8IHByb2ZpbGUuaWQsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaGFuZGxlIFNwb3RpZnkgY2FsbGJhY2s6JywgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8vIFNlYXJjaCB0cmFja3NcbiAgYXN5bmMgc2VhcmNoVHJhY2tzKHF1ZXJ5OiBzdHJpbmcsIGxpbWl0ID0gMjApOiBQcm9taXNlPFNwb3RpZnlUcmFja1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYm9keSB9ID0gYXdhaXQgdGhpcy5zcG90aWZ5QXBpLnNlYXJjaFRyYWNrcyhxdWVyeSwgeyBsaW1pdCB9KVxuICAgICAgXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIGJvZHkudHJhY2tzPy5pdGVtcy5tYXAodHJhY2sgPT4gdGhpcy5tYXBTcG90aWZ5VHJhY2sodHJhY2spKSB8fCBbXVxuICAgICAgKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2VhcmNoIFNwb3RpZnkgdHJhY2tzOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHVzZXIncyBzYXZlZCB0cmFja3NcbiAgYXN5bmMgZ2V0TGlrZWRUcmFja3MobGltaXQgPSA1MCwgb2Zmc2V0ID0gMCk6IFByb21pc2U8U3BvdGlmeVRyYWNrW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBib2R5IH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0TXlTYXZlZFRyYWNrcyh7IGxpbWl0LCBvZmZzZXQgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBib2R5Lml0ZW1zLm1hcChpdGVtID0+IHRoaXMubWFwU3BvdGlmeVRyYWNrKGl0ZW0udHJhY2spKVxuICAgICAgKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGxpa2VkIHRyYWNrczonLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIC8vIEdldCB1c2VyJ3MgcGxheWxpc3RzXG4gIGFzeW5jIGdldFVzZXJQbGF5bGlzdHMobGltaXQgPSA1MCwgb2Zmc2V0ID0gMCk6IFByb21pc2U8U3BvdGlmeVBsYXlsaXN0W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBib2R5IH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0VXNlclBsYXlsaXN0cyh7IGxpbWl0LCBvZmZzZXQgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBib2R5Lml0ZW1zLm1hcChwbGF5bGlzdCA9PiB0aGlzLm1hcFNwb3RpZnlQbGF5bGlzdChwbGF5bGlzdCkpXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgdXNlciBwbGF5bGlzdHM6JywgZXJyb3IpXG4gICAgICByZXR1cm4gW11cbiAgICB9XG4gIH1cblxuICAvLyBHZXQgcGxheWxpc3QgdHJhY2tzXG4gIGFzeW5jIGdldFBsYXlsaXN0VHJhY2tzKHBsYXlsaXN0SWQ6IHN0cmluZyk6IFByb21pc2U8U3BvdGlmeVRyYWNrW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBib2R5IH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0UGxheWxpc3RUcmFja3MocGxheWxpc3RJZClcbiAgICAgIFxuICAgICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBib2R5Lml0ZW1zXG4gICAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0udHJhY2spXG4gICAgICAgICAgLm1hcChpdGVtID0+IHRoaXMubWFwU3BvdGlmeVRyYWNrKGl0ZW0udHJhY2spKVxuICAgICAgKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2V0IHBsYXlsaXN0IHRyYWNrczonLCBlcnJvcilcbiAgICAgIHJldHVybiBbXVxuICAgIH1cbiAgfVxuXG4gIC8vIEdldCB1c2VyJ3MgdG9wIHRyYWNrc1xuICBhc3luYyBnZXRUb3BUcmFja3MobGltaXQgPSAyMCk6IFByb21pc2U8U3BvdGlmeVRyYWNrW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBib2R5IH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0TXlUb3BUcmFja3MoeyBsaW1pdCB9KVxuICAgICAgXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIGJvZHkuaXRlbXMubWFwKHRyYWNrID0+IHRoaXMubWFwU3BvdGlmeVRyYWNrKHRyYWNrKSlcbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCB0b3AgdHJhY2tzOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHJlY2VudGx5IHBsYXllZCB0cmFja3NcbiAgYXN5bmMgZ2V0UmVjZW50bHlQbGF5ZWQobGltaXQgPSAyMCk6IFByb21pc2U8U3BvdGlmeVRyYWNrW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBib2R5IH0gPSBhd2FpdCB0aGlzLnNwb3RpZnlBcGkuZ2V0TXlSZWNlbnRseVBsYXllZFRyYWNrcyh7IGxpbWl0IH0pXG4gICAgICBcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgYm9keS5pdGVtcy5tYXAoaXRlbSA9PiB0aGlzLm1hcFNwb3RpZnlUcmFjayhpdGVtLnRyYWNrKSlcbiAgICAgIClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCByZWNlbnRseSBwbGF5ZWQgdHJhY2tzOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHJlY29tbWVuZGF0aW9uc1xuICBhc3luYyBnZXRSZWNvbW1lbmRhdGlvbnMoc2VlZFRyYWNrcz86IHN0cmluZ1tdLCBzZWVkQXJ0aXN0cz86IHN0cmluZ1tdLCBzZWVkR2VucmVzPzogc3RyaW5nW10sIGxpbWl0ID0gMjApOiBQcm9taXNlPFNwb3RpZnlUcmFja1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYm9keSB9ID0gYXdhaXQgdGhpcy5zcG90aWZ5QXBpLmdldFJlY29tbWVuZGF0aW9ucyh7XG4gICAgICAgIHNlZWRfdHJhY2tzOiBzZWVkVHJhY2tzPy5zbGljZSgwLCA1KSxcbiAgICAgICAgc2VlZF9hcnRpc3RzOiBzZWVkQXJ0aXN0cz8uc2xpY2UoMCwgNSksXG4gICAgICAgIHNlZWRfZ2VucmVzOiBzZWVkR2VucmVzPy5zbGljZSgwLCA1KSxcbiAgICAgICAgbGltaXQsXG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIGJvZHkudHJhY2tzLm1hcCh0cmFjayA9PiB0aGlzLm1hcFNwb3RpZnlUcmFjayh0cmFjaykpXG4gICAgICApXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVjb21tZW5kYXRpb25zOicsIGVycm9yKVxuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IHRyYWNrIGRldGFpbHNcbiAgYXN5bmMgZ2V0VHJhY2sodHJhY2tJZDogc3RyaW5nKTogUHJvbWlzZTxTcG90aWZ5VHJhY2sgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYm9keSB9ID0gYXdhaXQgdGhpcy5zcG90aWZ5QXBpLmdldFRyYWNrKHRyYWNrSWQpXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYXBTcG90aWZ5VHJhY2soYm9keSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCB0cmFjazonLCBlcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGFsYnVtIGRldGFpbHNcbiAgYXN5bmMgZ2V0QWxidW0oYWxidW1JZDogc3RyaW5nKTogUHJvbWlzZTxTcG90aWZ5QWxidW0gfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYm9keSB9ID0gYXdhaXQgdGhpcy5zcG90aWZ5QXBpLmdldEFsYnVtKGFsYnVtSWQpXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYXBTcG90aWZ5QWxidW0oYm9keSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBhbGJ1bTonLCBlcnJvcilcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG5cbiAgLy8gR2V0IGFydGlzdCBkZXRhaWxzXG4gIGFzeW5jIGdldEFydGlzdChhcnRpc3RJZDogc3RyaW5nKTogUHJvbWlzZTxTcG90aWZ5QXJ0aXN0IHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGJvZHkgfSA9IGF3YWl0IHRoaXMuc3BvdGlmeUFwaS5nZXRBcnRpc3QoYXJ0aXN0SWQpXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5tYXBTcG90aWZ5QXJ0aXN0KGJvZHkpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgYXJ0aXN0OicsIGVycm9yKVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICAvLyBNYXAgU3BvdGlmeSB0cmFjayB0byB1bmlmaWVkIGZvcm1hdFxuICBwcml2YXRlIGFzeW5jIG1hcFNwb3RpZnlUcmFjayh0cmFjazogU3BvdGlmeUFwaS5UcmFja09iamVjdEZ1bGwpOiBQcm9taXNlPFNwb3RpZnlUcmFjaz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDaGVjayBpZiB0cmFjayBleGlzdHMgaW4gb3VyIGRhdGFiYXNlXG4gICAgICBsZXQgc3VwYWJhc2VUcmFjayA9IGF3YWl0IHRoaXMuZmluZE9yQ3JlYXRlVHJhY2sodHJhY2spXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBzdXBhYmFzZVRyYWNrLmlkLFxuICAgICAgICB0aXRsZTogdHJhY2submFtZSxcbiAgICAgICAgYXJ0aXN0OiBhd2FpdCB0aGlzLm1hcFNwb3RpZnlBcnRpc3QodHJhY2suYXJ0aXN0c1swXSksXG4gICAgICAgIGFsYnVtOiBhd2FpdCB0aGlzLm1hcFNwb3RpZnlBbGJ1bSh0cmFjay5hbGJ1bSksXG4gICAgICAgIGR1cmF0aW9uOiB0cmFjay5kdXJhdGlvbl9tcyAvIDEwMDAsIC8vIENvbnZlcnQgdG8gc2Vjb25kc1xuICAgICAgICBzdHJlYW1Vcmw6IGBzcG90aWZ5OnRyYWNrOiR7dHJhY2suaWR9YCxcbiAgICAgICAgcHJldmlld1VybDogdHJhY2sucHJldmlld191cmwgfHwgdW5kZWZpbmVkLFxuICAgICAgICBpc0xpa2VkOiBmYWxzZSwgLy8gV2lsbCBiZSB1cGRhdGVkIGJ5IHVzZXIgbGlicmFyeVxuICAgICAgICBwbGF5Q291bnQ6IDAsIC8vIFdpbGwgYmUgdXBkYXRlZCBieSBhbmFseXRpY3NcbiAgICAgICAgYXJ0d29yazogdHJhY2suYWxidW0uaW1hZ2VzICYmIHRyYWNrLmFsYnVtLmltYWdlcy5sZW5ndGggPiAwID8gdHJhY2suYWxidW0uaW1hZ2VzWzBdLnVybCA6ICcnLFxuICAgICAgICBnZW5yZXM6IFtdLCAvLyBXaWxsIGJlIHBvcHVsYXRlZCBmcm9tIGFydGlzdFxuICAgICAgICByZWxlYXNlRGF0ZTogdHJhY2suYWxidW0ucmVsZWFzZV9kYXRlLFxuICAgICAgICBzZXJ2aWNlSWQ6ICdzcG90aWZ5JyxcbiAgICAgICAgb3JpZ2luYWxJZDogdHJhY2suaWQsXG4gICAgICAgIGF2YWlsYWJsZVNlcnZpY2VzOiBbJ3Nwb3RpZnknXSxcbiAgICAgICAgcXVhbGl0eTogJ2hpZ2gnLFxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXBwaW5nIFNwb3RpZnkgdHJhY2s6JywgZXJyb3IpXG4gICAgICAvLyBSZXR1cm4gYSBtaW5pbWFsIHRyYWNrIG9iamVjdFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHRyYWNrLmlkLFxuICAgICAgICB0aXRsZTogdHJhY2submFtZSxcbiAgICAgICAgYXJ0aXN0OiB7XG4gICAgICAgICAgaWQ6IHRyYWNrLmFydGlzdHNbMF0/LmlkIHx8ICd1bmtub3duJyxcbiAgICAgICAgICBuYW1lOiB0cmFjay5hcnRpc3RzWzBdPy5uYW1lIHx8ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgaW1hZ2U6ICcnLFxuICAgICAgICAgIGZvbGxvd2VyczogMCxcbiAgICAgICAgICBpc0ZvbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICBnZW5yZXM6IFtdLFxuICAgICAgICAgIHNlcnZpY2VJZDogJ3Nwb3RpZnknLFxuICAgICAgICAgIG9yaWdpbmFsSWQ6IHRyYWNrLmFydGlzdHNbMF0/LmlkIHx8ICd1bmtub3duJyxcbiAgICAgICAgICBhdmFpbGFibGVTZXJ2aWNlczogWydzcG90aWZ5J10sXG4gICAgICAgIH0sXG4gICAgICAgIGFsYnVtOiB7XG4gICAgICAgICAgaWQ6IHRyYWNrLmFsYnVtPy5pZCB8fCAndW5rbm93bicsXG4gICAgICAgICAgdGl0bGU6IHRyYWNrLmFsYnVtPy5uYW1lIHx8ICdVbmtub3duIEFsYnVtJyxcbiAgICAgICAgICBhcnRpc3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cmFjay5hcnRpc3RzWzBdPy5pZCB8fCAndW5rbm93bicsXG4gICAgICAgICAgICBuYW1lOiB0cmFjay5hcnRpc3RzWzBdPy5uYW1lIHx8ICdVbmtub3duIEFydGlzdCcsXG4gICAgICAgICAgICBpbWFnZTogJycsXG4gICAgICAgICAgICBmb2xsb3dlcnM6IDAsXG4gICAgICAgICAgICBpc0ZvbGxvd2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGdlbnJlczogW10sXG4gICAgICAgICAgICBzZXJ2aWNlSWQ6ICdzcG90aWZ5JyxcbiAgICAgICAgICAgIG9yaWdpbmFsSWQ6IHRyYWNrLmFydGlzdHNbMF0/LmlkIHx8ICd1bmtub3duJyxcbiAgICAgICAgICAgIGF2YWlsYWJsZVNlcnZpY2VzOiBbJ3Nwb3RpZnknXSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFydHdvcms6IHRyYWNrLmFsYnVtPy5pbWFnZXMgJiYgdHJhY2suYWxidW0uaW1hZ2VzLmxlbmd0aCA+IDAgPyB0cmFjay5hbGJ1bS5pbWFnZXNbMF0udXJsIDogJycsXG4gICAgICAgICAgcmVsZWFzZURhdGU6IHRyYWNrLmFsYnVtPy5yZWxlYXNlX2RhdGUgfHwgJycsXG4gICAgICAgICAgdHJhY2tzOiBbXSxcbiAgICAgICAgICB0b3RhbFRyYWNrczogdHJhY2suYWxidW0/LnRvdGFsX3RyYWNrcyB8fCAwLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgICAgIGdlbnJlczogW10sXG4gICAgICAgICAgdHlwZTogJ2FsYnVtJyxcbiAgICAgICAgICBzZXJ2aWNlSWQ6ICdzcG90aWZ5JyxcbiAgICAgICAgICBvcmlnaW5hbElkOiB0cmFjay5hbGJ1bT8uaWQgfHwgJ3Vua25vd24nLFxuICAgICAgICAgIGF2YWlsYWJsZVNlcnZpY2VzOiBbJ3Nwb3RpZnknXSxcbiAgICAgICAgfSxcbiAgICAgICAgZHVyYXRpb246IHRyYWNrLmR1cmF0aW9uX21zIC8gMTAwMCxcbiAgICAgICAgc3RyZWFtVXJsOiBgc3BvdGlmeTp0cmFjazoke3RyYWNrLmlkfWAsXG4gICAgICAgIHByZXZpZXdVcmw6IHRyYWNrLnByZXZpZXdfdXJsIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgaXNMaWtlZDogZmFsc2UsXG4gICAgICAgIHBsYXlDb3VudDogMCxcbiAgICAgICAgYXJ0d29yazogdHJhY2suYWxidW0/LmltYWdlcyAmJiB0cmFjay5hbGJ1bS5pbWFnZXMubGVuZ3RoID4gMCA/IHRyYWNrLmFsYnVtLmltYWdlc1swXS51cmwgOiAnJyxcbiAgICAgICAgZ2VucmVzOiBbXSxcbiAgICAgICAgcmVsZWFzZURhdGU6IHRyYWNrLmFsYnVtPy5yZWxlYXNlX2RhdGUgfHwgJycsXG4gICAgICAgIHNlcnZpY2VJZDogJ3Nwb3RpZnknLFxuICAgICAgICBvcmlnaW5hbElkOiB0cmFjay5pZCxcbiAgICAgICAgYXZhaWxhYmxlU2VydmljZXM6IFsnc3BvdGlmeSddLFxuICAgICAgICBxdWFsaXR5OiAnaGlnaCcsXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gTWFwIFNwb3RpZnkgYXJ0aXN0IHRvIHVuaWZpZWQgZm9ybWF0XG4gIHByaXZhdGUgYXN5bmMgbWFwU3BvdGlmeUFydGlzdChhcnRpc3Q6IFNwb3RpZnlBcGkuQXJ0aXN0T2JqZWN0RnVsbCk6IFByb21pc2U8U3BvdGlmeUFydGlzdD4ge1xuICAgIC8vIENoZWNrIGlmIGFydGlzdCBleGlzdHMgaW4gb3VyIGRhdGFiYXNlXG4gICAgbGV0IHN1cGFiYXNlQXJ0aXN0ID0gYXdhaXQgdGhpcy5maW5kT3JDcmVhdGVBcnRpc3QoYXJ0aXN0KVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpZDogc3VwYWJhc2VBcnRpc3QuaWQsXG4gICAgICBuYW1lOiBhcnRpc3QubmFtZSxcbiAgICAgIGltYWdlOiBhcnRpc3QuaW1hZ2VzWzBdPy51cmwgfHwgJycsXG4gICAgICBmb2xsb3dlcnM6IGFydGlzdC5mb2xsb3dlcnM/LnRvdGFsIHx8IDAsXG4gICAgICBpc0ZvbGxvd2VkOiBmYWxzZSwgLy8gV2lsbCBiZSB1cGRhdGVkIGJ5IHVzZXIgZm9sbG93c1xuICAgICAgZ2VucmVzOiBhcnRpc3QuZ2VucmVzIHx8IFtdLFxuICAgICAgYmlvOiB1bmRlZmluZWQsIC8vIFNwb3RpZnkgZG9lc24ndCBwcm92aWRlIGJpbyBpbiBiYXNpYyBhcnRpc3Qgb2JqZWN0XG4gICAgICBzZXJ2aWNlSWQ6ICdzcG90aWZ5JyxcbiAgICAgIG9yaWdpbmFsSWQ6IGFydGlzdC5pZCxcbiAgICAgIGF2YWlsYWJsZVNlcnZpY2VzOiBbJ3Nwb3RpZnknXSxcbiAgICB9XG4gIH1cblxuICAvLyBNYXAgU3BvdGlmeSBhbGJ1bSB0byB1bmlmaWVkIGZvcm1hdFxuICBwcml2YXRlIGFzeW5jIG1hcFNwb3RpZnlBbGJ1bShhbGJ1bTogU3BvdGlmeUFwaS5BbGJ1bU9iamVjdEZ1bGwpOiBQcm9taXNlPFNwb3RpZnlBbGJ1bT4ge1xuICAgIC8vIENoZWNrIGlmIGFsYnVtIGV4aXN0cyBpbiBvdXIgZGF0YWJhc2VcbiAgICBsZXQgc3VwYWJhc2VBbGJ1bSA9IGF3YWl0IHRoaXMuZmluZE9yQ3JlYXRlQWxidW0oYWxidW0pXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBzdXBhYmFzZUFsYnVtLmlkLFxuICAgICAgdGl0bGU6IGFsYnVtLm5hbWUsXG4gICAgICBhcnRpc3Q6IGF3YWl0IHRoaXMubWFwU3BvdGlmeUFydGlzdChhbGJ1bS5hcnRpc3RzWzBdKSxcbiAgICAgIGFydHdvcms6IGFsYnVtLmltYWdlc1swXT8udXJsIHx8ICcnLFxuICAgICAgcmVsZWFzZURhdGU6IGFsYnVtLnJlbGVhc2VfZGF0ZSxcbiAgICAgIHRyYWNrczogW10sIC8vIFdpbGwgYmUgcG9wdWxhdGVkIHNlcGFyYXRlbHlcbiAgICAgIHRvdGFsVHJhY2tzOiBhbGJ1bS50b3RhbF90cmFja3MsXG4gICAgICBkdXJhdGlvbjogMCwgLy8gV2lsbCBiZSBjYWxjdWxhdGVkIGZyb20gdHJhY2tzXG4gICAgICBnZW5yZXM6IGFsYnVtLmdlbnJlcyB8fCBbXSxcbiAgICAgIHR5cGU6IGFsYnVtLmFsYnVtX3R5cGUgYXMgJ2FsYnVtJyB8ICdzaW5nbGUnIHwgJ2VwJyxcbiAgICAgIHNlcnZpY2VJZDogJ3Nwb3RpZnknLFxuICAgICAgb3JpZ2luYWxJZDogYWxidW0uaWQsXG4gICAgICBhdmFpbGFibGVTZXJ2aWNlczogWydzcG90aWZ5J10sXG4gICAgfVxuICB9XG5cbiAgLy8gTWFwIFNwb3RpZnkgcGxheWxpc3QgdG8gdW5pZmllZCBmb3JtYXRcbiAgcHJpdmF0ZSBhc3luYyBtYXBTcG90aWZ5UGxheWxpc3QocGxheWxpc3Q6IFNwb3RpZnlBcGkuUGxheWxpc3RPYmplY3RTaW1wbGlmaWVkKTogUHJvbWlzZTxTcG90aWZ5UGxheWxpc3Q+IHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHBsYXlsaXN0LmlkLFxuICAgICAgdGl0bGU6IHBsYXlsaXN0Lm5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogcGxheWxpc3QuZGVzY3JpcHRpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgY3JlYXRvcjoge1xuICAgICAgICBpZDogcGxheWxpc3Qub3duZXIuaWQsXG4gICAgICAgIG5hbWU6IHBsYXlsaXN0Lm93bmVyLmRpc3BsYXlfbmFtZSB8fCBwbGF5bGlzdC5vd25lci5pZCxcbiAgICAgICAgaW1hZ2U6IHVuZGVmaW5lZCwgLy8gV2lsbCBiZSBmZXRjaGVkIHNlcGFyYXRlbHkgaWYgbmVlZGVkXG4gICAgICB9LFxuICAgICAgdHJhY2tzOiBbXSwgLy8gV2lsbCBiZSBwb3B1bGF0ZWQgc2VwYXJhdGVseVxuICAgICAgYXJ0d29yazogcGxheWxpc3QuaW1hZ2VzWzBdPy51cmwgfHwgJycsXG4gICAgICBpc1B1YmxpYzogcGxheWxpc3QucHVibGljLFxuICAgICAgaXNMaWtlZDogZmFsc2UsIC8vIFdpbGwgYmUgdXBkYXRlZCBieSB1c2VyIGxpYnJhcnlcbiAgICAgIGZvbGxvd2VyczogcGxheWxpc3QuZm9sbG93ZXJzPy50b3RhbCB8fCAwLFxuICAgICAgY3JlYXRlZEF0OiBwbGF5bGlzdC5jcmVhdGVkX2F0LFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksIC8vIFNwb3RpZnkgZG9lc24ndCBwcm92aWRlIHRoaXNcbiAgICAgIHNlcnZpY2VJZDogJ3Nwb3RpZnknLFxuICAgICAgb3JpZ2luYWxJZDogcGxheWxpc3QuaWQsXG4gICAgICBhdmFpbGFibGVTZXJ2aWNlczogWydzcG90aWZ5J10sXG4gICAgfVxuICB9XG5cbiAgLy8gRmluZCBvciBjcmVhdGUgdHJhY2sgaW4gZGF0YWJhc2VcbiAgcHJpdmF0ZSBhc3luYyBmaW5kT3JDcmVhdGVUcmFjayh0cmFjazogU3BvdGlmeUFwaS5UcmFja09iamVjdEZ1bGwpOiBQcm9taXNlPFN1cGFiYXNlVHJhY2s+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRmlyc3QgdHJ5IHRvIGZpbmQgYnkgSVNSQ1xuICAgICAgaWYgKHRyYWNrLmV4dGVybmFsX2lkcz8uaXNyYykge1xuICAgICAgICBjb25zdCBleGlzdGluZ1RyYWNrID0gYXdhaXQgc3VwYWJhc2VTZXJ2aWNlLnNlYXJjaFRyYWNrcyh0cmFjay5leHRlcm5hbF9pZHMuaXNyYywgMSlcbiAgICAgICAgaWYgKGV4aXN0aW5nVHJhY2subGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBleGlzdGluZ1RyYWNrWzBdXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIG5ldyB0cmFja1xuICAgICAgY29uc3QgYXJ0aXN0ID0gYXdhaXQgdGhpcy5maW5kT3JDcmVhdGVBcnRpc3QodHJhY2suYXJ0aXN0c1swXSlcbiAgICAgIGNvbnN0IGFsYnVtID0gYXdhaXQgdGhpcy5maW5kT3JDcmVhdGVBbGJ1bSh0cmFjay5hbGJ1bSlcblxuICAgICAgY29uc3QgbmV3VHJhY2sgPSBhd2FpdCBzdXBhYmFzZVNlcnZpY2UuY3JlYXRlVHJhY2soe1xuICAgICAgICB0aXRsZTogdHJhY2submFtZSxcbiAgICAgICAgYXJ0aXN0X2lkOiBhcnRpc3QuaWQsXG4gICAgICAgIGFsYnVtX2lkOiBhbGJ1bS5pZCxcbiAgICAgICAgZHVyYXRpb246IE1hdGguZmxvb3IodHJhY2suZHVyYXRpb25fbXMgLyAxMDAwKSxcbiAgICAgICAgdHJhY2tfbnVtYmVyOiB0cmFjay50cmFja19udW1iZXIsXG4gICAgICAgIGRpc2NfbnVtYmVyOiB0cmFjay5kaXNjX251bWJlcixcbiAgICAgICAgaXNyYzogdHJhY2suZXh0ZXJuYWxfaWRzPy5pc3JjIHx8IG51bGwsXG4gICAgICAgIGV4dGVybmFsX3VybDogdHJhY2suZXh0ZXJuYWxfdXJscz8uc3BvdGlmeSB8fCBudWxsLFxuICAgICAgfSlcblxuICAgICAgLy8gQWRkIFNwb3RpZnkgc2VydmljZSBtYXBwaW5nXG4gICAgICBhd2FpdCBzdXBhYmFzZVNlcnZpY2UuYWRkVHJhY2tTZXJ2aWNlKHtcbiAgICAgICAgdHJhY2tfaWQ6IG5ld1RyYWNrLmlkLFxuICAgICAgICBzZXJ2aWNlX2lkOiAnc3BvdGlmeScsXG4gICAgICAgIHNlcnZpY2VfdHJhY2tfaWQ6IHRyYWNrLmlkLFxuICAgICAgICBzdHJlYW1fdXJsOiBgc3BvdGlmeTp0cmFjazoke3RyYWNrLmlkfWAsXG4gICAgICAgIHByZXZpZXdfdXJsOiB0cmFjay5wcmV2aWV3X3VybCB8fCBudWxsLFxuICAgICAgICBxdWFsaXR5OiAnaGlnaCcsXG4gICAgICAgIGlzX2F2YWlsYWJsZTogdHJ1ZSxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiBuZXdUcmFja1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyB0cmFjazonLCBlcnJvcilcbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgbW9jayB0cmFjayBvYmplY3QgaWYgZGF0YWJhc2UgY3JlYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBgbW9jay10cmFjay0ke3RyYWNrLmlkfWAsXG4gICAgICAgIHRpdGxlOiB0cmFjay5uYW1lLFxuICAgICAgICBhcnRpc3RfaWQ6IGBtb2NrLSR7dHJhY2suYXJ0aXN0c1swXS5pZH1gLFxuICAgICAgICBhbGJ1bV9pZDogYG1vY2stYWxidW0tJHt0cmFjay5hbGJ1bS5pZH1gLFxuICAgICAgICBkdXJhdGlvbjogTWF0aC5mbG9vcih0cmFjay5kdXJhdGlvbl9tcyAvIDEwMDApLFxuICAgICAgICB0cmFja19udW1iZXI6IHRyYWNrLnRyYWNrX251bWJlcixcbiAgICAgICAgZGlzY19udW1iZXI6IHRyYWNrLmRpc2NfbnVtYmVyLFxuICAgICAgICBpc3JjOiB0cmFjay5leHRlcm5hbF9pZHM/LmlzcmMgfHwgbnVsbCxcbiAgICAgICAgZXh0ZXJuYWxfdXJsOiB0cmFjay5leHRlcm5hbF91cmxzPy5zcG90aWZ5IHx8IG51bGwsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEZpbmQgb3IgY3JlYXRlIGFydGlzdCBpbiBkYXRhYmFzZVxuICBwcml2YXRlIGFzeW5jIGZpbmRPckNyZWF0ZUFydGlzdChhcnRpc3Q6IFNwb3RpZnlBcGkuQXJ0aXN0T2JqZWN0RnVsbCk6IFByb21pc2U8U3VwYWJhc2VBcnRpc3Q+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdBcnRpc3RzID0gYXdhaXQgc3VwYWJhc2VTZXJ2aWNlLnNlYXJjaEFydGlzdHMoYXJ0aXN0Lm5hbWUsIDEpXG4gICAgICBpZiAoZXhpc3RpbmdBcnRpc3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nQXJ0aXN0c1swXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXdhaXQgc3VwYWJhc2VTZXJ2aWNlLmNyZWF0ZUFydGlzdCh7XG4gICAgICAgIG5hbWU6IGFydGlzdC5uYW1lLFxuICAgICAgICBpbWFnZV91cmw6IGFydGlzdC5pbWFnZXMgJiYgYXJ0aXN0LmltYWdlcy5sZW5ndGggPiAwID8gYXJ0aXN0LmltYWdlc1swXS51cmwgOiBudWxsLFxuICAgICAgICBiaW86IG51bGwsIC8vIFNwb3RpZnkgZG9lc24ndCBwcm92aWRlIGJpbyBpbiBiYXNpYyBhcnRpc3Qgb2JqZWN0XG4gICAgICAgIGdlbnJlczogYXJ0aXN0LmdlbnJlcyB8fCBbXSxcbiAgICAgICAgZXh0ZXJuYWxfdXJsOiBhcnRpc3QuZXh0ZXJuYWxfdXJscz8uc3BvdGlmeSB8fCBudWxsLFxuICAgICAgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFwcGluZyBTcG90aWZ5IHRyYWNrOicsIGVycm9yKVxuICAgICAgXG4gICAgICAvLyBSZXR1cm4gYSBtb2NrIGFydGlzdCBvYmplY3QgaWYgZGF0YWJhc2UgY3JlYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBgbW9jay0ke2FydGlzdC5pZH1gLFxuICAgICAgICBuYW1lOiBhcnRpc3QubmFtZSxcbiAgICAgICAgaW1hZ2VfdXJsOiBhcnRpc3QuaW1hZ2VzICYmIGFydGlzdC5pbWFnZXMubGVuZ3RoID4gMCA/IGFydGlzdC5pbWFnZXNbMF0udXJsIDogbnVsbCxcbiAgICAgICAgYmlvOiBudWxsLFxuICAgICAgICBnZW5yZXM6IGFydGlzdC5nZW5yZXMgfHwgW10sXG4gICAgICAgIGV4dGVybmFsX3VybDogYXJ0aXN0LmV4dGVybmFsX3VybHM/LnNwb3RpZnkgfHwgbnVsbCxcbiAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gRmluZCBvciBjcmVhdGUgYWxidW0gaW4gZGF0YWJhc2VcbiAgcHJpdmF0ZSBhc3luYyBmaW5kT3JDcmVhdGVBbGJ1bShhbGJ1bTogU3BvdGlmeUFwaS5BbGJ1bU9iamVjdEZ1bGwpOiBQcm9taXNlPFN1cGFiYXNlQWxidW0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdBbGJ1bXMgPSBhd2FpdCBzdXBhYmFzZVNlcnZpY2Uuc2VhcmNoQWxidW1zKGFsYnVtLm5hbWUsIDEpXG4gICAgICBpZiAoZXhpc3RpbmdBbGJ1bXMubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZXhpc3RpbmdBbGJ1bXNbMF1cbiAgICAgIH1cblxuICAgICAgY29uc3QgYXJ0aXN0ID0gYXdhaXQgdGhpcy5maW5kT3JDcmVhdGVBcnRpc3QoYWxidW0uYXJ0aXN0c1swXSlcblxuICAgICAgcmV0dXJuIGF3YWl0IHN1cGFiYXNlU2VydmljZS5jcmVhdGVBbGJ1bSh7XG4gICAgICAgIHRpdGxlOiBhbGJ1bS5uYW1lLFxuICAgICAgICBhcnRpc3RfaWQ6IGFydGlzdC5pZCxcbiAgICAgICAgYXJ0d29ya191cmw6IGFsYnVtLmltYWdlcyAmJiBhbGJ1bS5pbWFnZXMubGVuZ3RoID4gMCA/IGFsYnVtLmltYWdlc1swXS51cmwgOiBudWxsLFxuICAgICAgICByZWxlYXNlX2RhdGU6IGFsYnVtLnJlbGVhc2VfZGF0ZSxcbiAgICAgICAgdG90YWxfdHJhY2tzOiBhbGJ1bS50b3RhbF90cmFja3MsXG4gICAgICAgIGR1cmF0aW9uOiAwLCAvLyBXaWxsIGJlIGNhbGN1bGF0ZWQgZnJvbSB0cmFja3NcbiAgICAgICAgZ2VucmVzOiBhbGJ1bS5nZW5yZXMgfHwgW10sXG4gICAgICAgIGFsYnVtX3R5cGU6IGFsYnVtLmFsYnVtX3R5cGUgYXMgJ2FsYnVtJyB8ICdzaW5nbGUnIHwgJ2VwJyxcbiAgICAgICAgZXh0ZXJuYWxfdXJsOiBhbGJ1bS5leHRlcm5hbF91cmxzPy5zcG90aWZ5IHx8IG51bGwsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBhbGJ1bTonLCBlcnJvcilcbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgbW9jayBhbGJ1bSBvYmplY3QgaWYgZGF0YWJhc2UgY3JlYXRpb24gZmFpbHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBgbW9jay1hbGJ1bS0ke2FsYnVtLmlkfWAsXG4gICAgICAgIHRpdGxlOiBhbGJ1bS5uYW1lLFxuICAgICAgICBhcnRpc3RfaWQ6IGBtb2NrLSR7YWxidW0uYXJ0aXN0c1swXS5pZH1gLFxuICAgICAgICBhcnR3b3JrX3VybDogYWxidW0uaW1hZ2VzICYmIGFsYnVtLmltYWdlcy5sZW5ndGggPiAwID8gYWxidW0uaW1hZ2VzWzBdLnVybCA6IG51bGwsXG4gICAgICAgIHJlbGVhc2VfZGF0ZTogYWxidW0ucmVsZWFzZV9kYXRlLFxuICAgICAgICB0b3RhbF90cmFja3M6IGFsYnVtLnRvdGFsX3RyYWNrcyxcbiAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgIGdlbnJlczogYWxidW0uZ2VucmVzIHx8IFtdLFxuICAgICAgICBhbGJ1bV90eXBlOiBhbGJ1bS5hbGJ1bV90eXBlIGFzICdhbGJ1bScgfCAnc2luZ2xlJyB8ICdlcCcsXG4gICAgICAgIGV4dGVybmFsX3VybDogYWxidW0uZXh0ZXJuYWxfdXJscz8uc3BvdGlmeSB8fCBudWxsLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBBZGQgdHJhY2sgc2VydmljZSBtYXBwaW5nIChoZWxwZXIgbWV0aG9kKVxuICBwcml2YXRlIGFzeW5jIGFkZFRyYWNrU2VydmljZSh0cmFja1NlcnZpY2U6IHtcbiAgICB0cmFja19pZDogc3RyaW5nXG4gICAgc2VydmljZV9pZDogTXVzaWNTZXJ2aWNlXG4gICAgc2VydmljZV90cmFja19pZDogc3RyaW5nXG4gICAgc3RyZWFtX3VybD86IHN0cmluZyB8IG51bGxcbiAgICBwcmV2aWV3X3VybD86IHN0cmluZyB8IG51bGxcbiAgICBxdWFsaXR5PzogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdsb3NzbGVzcydcbiAgICBpc19hdmFpbGFibGU/OiBib29sZWFuXG4gIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBUaGlzIHdvdWxkIGJlIGltcGxlbWVudGVkIGluIHRoZSBTdXBhYmFzZVNlcnZpY2VcbiAgICAvLyBGb3Igbm93LCB3ZSdsbCB1c2UgdGhlIGRpcmVjdCBTdXBhYmFzZSBjbGllbnRcbiAgICBjb25zdCB7IGNyZWF0ZUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KCdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInKVxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KClcbiAgICBcbiAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3RyYWNrX3NlcnZpY2VzJylcbiAgICAgIC5pbnNlcnQodHJhY2tTZXJ2aWNlKVxuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHMgZm9yIFN1cGFiYXNlU2VydmljZSAodGhlc2Ugd291bGQgYmUgYWRkZWQgdG8gdGhlIHNlcnZpY2UpXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlVHJhY2sodHJhY2tEYXRhOiBhbnkpOiBQcm9taXNlPFN1cGFiYXNlVHJhY2s+IHtcbiAgICBjb25zdCB7IGNyZWF0ZUNsaWVudCB9ID0gYXdhaXQgaW1wb3J0KCdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInKVxuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KClcbiAgICBcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3RyYWNrcycpXG4gICAgICAuaW5zZXJ0KHRyYWNrRGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG4gICAgXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUFydGlzdChhcnRpc3REYXRhOiBhbnkpOiBQcm9taXNlPFN1cGFiYXNlQXJ0aXN0PiB7XG4gICAgY29uc3QgeyBjcmVhdGVDbGllbnQgfSA9IGF3YWl0IGltcG9ydCgnQC9saWIvc3VwYWJhc2Uvc2VydmVyJylcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpXG4gICAgXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhcnRpc3RzJylcbiAgICAgIC5pbnNlcnQoYXJ0aXN0RGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG4gICAgXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZUFsYnVtKGFsYnVtRGF0YTogYW55KTogUHJvbWlzZTxTdXBhYmFzZUFsYnVtPiB7XG4gICAgY29uc3QgeyBjcmVhdGVDbGllbnQgfSA9IGF3YWl0IGltcG9ydCgnQC9saWIvc3VwYWJhc2Uvc2VydmVyJylcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpXG4gICAgXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhbGJ1bXMnKVxuICAgICAgLmluc2VydChhbGJ1bURhdGEpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuICAgIFxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBzcG90aWZ5U2VydmljZSA9IG5ldyBTcG90aWZ5U2VydmljZSgpXG4iXSwibmFtZXMiOlsiU3BvdGlmeVdlYkFwaSIsInN1cGFiYXNlU2VydmljZSIsInN1cGFiYXNlU2VydmVyU2VydmljZSIsIlNwb3RpZnlTZXJ2aWNlIiwiYWNjZXNzVG9rZW4iLCJyZWZyZXNoVG9rZW4iLCJleHBpcmVzQXQiLCJzcG90aWZ5QXBpIiwiY2xpZW50SWQiLCJwcm9jZXNzIiwiZW52IiwiU1BPVElGWV9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJTUE9USUZZX0NMSUVOVF9TRUNSRVQiLCJyZWRpcmVjdFVyaSIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJpbml0aWFsaXplIiwidXNlcklkIiwidXNlclNlcnZpY2VzIiwiZ2V0VXNlclNlcnZpY2VzIiwic3BvdGlmeVNlcnZpY2UiLCJmaW5kIiwicyIsInNlcnZpY2VfaWQiLCJhY2Nlc3NfdG9rZW4iLCJyZWZyZXNoX3Rva2VuIiwiZXhwaXJlc19hdCIsIkRhdGUiLCJnZXRUaW1lIiwic2V0QWNjZXNzVG9rZW4iLCJub3ciLCJyZWZyZXNoQWNjZXNzVG9rZW4iLCJlcnJvciIsImNvbnNvbGUiLCJFcnJvciIsInNldFJlZnJlc2hUb2tlbiIsImJvZHkiLCJleHBpcmVzX2luIiwiY29ubmVjdFNlcnZpY2UiLCJ1c2VyX2lkIiwidG9JU09TdHJpbmciLCJpc19hY3RpdmUiLCJnZXRBdXRob3JpemF0aW9uVXJsIiwic3RhdGUiLCJzY29wZXMiLCJjcmVhdGVBdXRob3JpemVVUkwiLCJoYW5kbGVDYWxsYmFjayIsImNvZGUiLCJhdXRob3JpemF0aW9uQ29kZUdyYW50IiwicHJvZmlsZSIsImdldE1lIiwic2VydmljZV91c2VyX2lkIiwiaWQiLCJzZXJ2aWNlX3VzZXJuYW1lIiwiZGlzcGxheV9uYW1lIiwic2VhcmNoVHJhY2tzIiwicXVlcnkiLCJsaW1pdCIsIlByb21pc2UiLCJhbGwiLCJ0cmFja3MiLCJpdGVtcyIsIm1hcCIsInRyYWNrIiwibWFwU3BvdGlmeVRyYWNrIiwiZ2V0TGlrZWRUcmFja3MiLCJvZmZzZXQiLCJnZXRNeVNhdmVkVHJhY2tzIiwiaXRlbSIsImdldFVzZXJQbGF5bGlzdHMiLCJwbGF5bGlzdCIsIm1hcFNwb3RpZnlQbGF5bGlzdCIsImdldFBsYXlsaXN0VHJhY2tzIiwicGxheWxpc3RJZCIsImZpbHRlciIsImdldFRvcFRyYWNrcyIsImdldE15VG9wVHJhY2tzIiwiZ2V0UmVjZW50bHlQbGF5ZWQiLCJnZXRNeVJlY2VudGx5UGxheWVkVHJhY2tzIiwiZ2V0UmVjb21tZW5kYXRpb25zIiwic2VlZFRyYWNrcyIsInNlZWRBcnRpc3RzIiwic2VlZEdlbnJlcyIsInNlZWRfdHJhY2tzIiwic2xpY2UiLCJzZWVkX2FydGlzdHMiLCJzZWVkX2dlbnJlcyIsImdldFRyYWNrIiwidHJhY2tJZCIsImdldEFsYnVtIiwiYWxidW1JZCIsIm1hcFNwb3RpZnlBbGJ1bSIsImdldEFydGlzdCIsImFydGlzdElkIiwibWFwU3BvdGlmeUFydGlzdCIsInN1cGFiYXNlVHJhY2siLCJmaW5kT3JDcmVhdGVUcmFjayIsInRpdGxlIiwibmFtZSIsImFydGlzdCIsImFydGlzdHMiLCJhbGJ1bSIsImR1cmF0aW9uIiwiZHVyYXRpb25fbXMiLCJzdHJlYW1VcmwiLCJwcmV2aWV3VXJsIiwicHJldmlld191cmwiLCJ1bmRlZmluZWQiLCJpc0xpa2VkIiwicGxheUNvdW50IiwiYXJ0d29yayIsImltYWdlcyIsImxlbmd0aCIsInVybCIsImdlbnJlcyIsInJlbGVhc2VEYXRlIiwicmVsZWFzZV9kYXRlIiwic2VydmljZUlkIiwib3JpZ2luYWxJZCIsImF2YWlsYWJsZVNlcnZpY2VzIiwicXVhbGl0eSIsImltYWdlIiwiZm9sbG93ZXJzIiwiaXNGb2xsb3dlZCIsInRvdGFsVHJhY2tzIiwidG90YWxfdHJhY2tzIiwidHlwZSIsInN1cGFiYXNlQXJ0aXN0IiwiZmluZE9yQ3JlYXRlQXJ0aXN0IiwidG90YWwiLCJiaW8iLCJzdXBhYmFzZUFsYnVtIiwiZmluZE9yQ3JlYXRlQWxidW0iLCJhbGJ1bV90eXBlIiwiZGVzY3JpcHRpb24iLCJjcmVhdG9yIiwib3duZXIiLCJpc1B1YmxpYyIsInB1YmxpYyIsImNyZWF0ZWRBdCIsImNyZWF0ZWRfYXQiLCJ1cGRhdGVkQXQiLCJleHRlcm5hbF9pZHMiLCJpc3JjIiwiZXhpc3RpbmdUcmFjayIsIm5ld1RyYWNrIiwiY3JlYXRlVHJhY2siLCJhcnRpc3RfaWQiLCJhbGJ1bV9pZCIsIk1hdGgiLCJmbG9vciIsInRyYWNrX251bWJlciIsImRpc2NfbnVtYmVyIiwiZXh0ZXJuYWxfdXJsIiwiZXh0ZXJuYWxfdXJscyIsInNwb3RpZnkiLCJhZGRUcmFja1NlcnZpY2UiLCJ0cmFja19pZCIsInNlcnZpY2VfdHJhY2tfaWQiLCJzdHJlYW1fdXJsIiwiaXNfYXZhaWxhYmxlIiwidXBkYXRlZF9hdCIsImV4aXN0aW5nQXJ0aXN0cyIsInNlYXJjaEFydGlzdHMiLCJjcmVhdGVBcnRpc3QiLCJpbWFnZV91cmwiLCJleGlzdGluZ0FsYnVtcyIsInNlYXJjaEFsYnVtcyIsImNyZWF0ZUFsYnVtIiwiYXJ0d29ya191cmwiLCJ0cmFja1NlcnZpY2UiLCJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZSIsImZyb20iLCJpbnNlcnQiLCJ0cmFja0RhdGEiLCJkYXRhIiwic2VsZWN0Iiwic2luZ2xlIiwiYXJ0aXN0RGF0YSIsImFsYnVtRGF0YSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/spotify-service.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/client.ts":
/*!********************************!*\
  !*** ./lib/supabase/client.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\nfunction createClient() {\n    return (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createBrowserClient)(\"https://nvwrmmuyzxanjvsadtfh.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52d3JtbXV5enhhbmp2c2FkdGZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MjgzNjQsImV4cCI6MjA3MTMwNDM2NH0.8k1x6zfO0KO9ExeDKcPP4FbaCA-BezxJWGHnNJ0VhQU\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UvY2xpZW50LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQW1EO0FBRTVDLFNBQVNDO0lBQ2QsT0FBT0Qsa0VBQW1CQSxDQUN4QkUsMENBQW9DLEVBQ3BDQSxrTkFBeUM7QUFFN0MiLCJzb3VyY2VzIjpbIi9Vc2Vycy9jYXJyaWV5dS9EZXNrdG9wL3Nwb3RpZnkvbGliL3N1cGFiYXNlL2NsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVCcm93c2VyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3NzcidcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNsaWVudCgpIHtcbiAgcmV0dXJuIGNyZWF0ZUJyb3dzZXJDbGllbnQoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSFcbiAgKVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUJyb3dzZXJDbGllbnQiLCJjcmVhdGVDbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/client.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SupabaseServerService: () => (/* binding */ SupabaseServerService),\n/* harmony export */   supabaseServerService: () => (/* binding */ supabaseServerService)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nclass SupabaseServerService {\n    // =====================================================\n    // USER OPERATIONS\n    // =====================================================\n    async getCurrentUser() {\n        try {\n            const { data: { user } } = await this.supabase.auth.getUser();\n            if (!user) return null;\n            const { data, error } = await this.supabase.from('users').select('*').eq('id', user.id).single();\n            if (error) {\n                console.error('Error getting user from database:', error);\n                return null;\n            }\n            return data;\n        } catch (error) {\n            console.error('Error getting current user:', error);\n            return null;\n        }\n    }\n    async createUser(userData) {\n        const { data, error } = await this.supabase.from('users').insert(userData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async updateUser(userId, updates) {\n        const { data, error } = await this.supabase.from('users').update(updates).eq('id', userId).select().single();\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // SERVICE CONNECTION OPERATIONS (Server-side)\n    // =====================================================\n    async getUserServices(userId) {\n        const { data, error } = await this.supabase.from('user_services').select('*').eq('user_id', userId).eq('is_active', true);\n        if (error) throw error;\n        return data;\n    }\n    async connectService(serviceData) {\n        try {\n            const { data, error } = await this.supabase.from('user_services').upsert(serviceData, {\n                onConflict: 'user_id,service_id'\n            }).select().single();\n            if (error) {\n                console.error('Error connecting service:', error);\n                // If it's an RLS error and we're using anon key, provide helpful message\n                if (error.message?.includes('row-level security') && process.env.SUPABASE_SERVICE_ROLE_KEY?.includes('0000000000000000000000000000000000000000')) {\n                    throw new Error('Service role key not configured. Please update SUPABASE_SERVICE_ROLE_KEY in your .env file with the real key from Supabase Dashboard.');\n                }\n                throw error;\n            }\n            return data;\n        } catch (error) {\n            console.error('Error in connectService:', error);\n            throw error;\n        }\n    }\n    async disconnectService(userId, serviceId) {\n        const { error } = await this.supabase.from('user_services').update({\n            is_active: false\n        }).eq('user_id', userId).eq('service_id', serviceId);\n        if (error) throw error;\n    }\n    async updateService(userId, serviceId, updates) {\n        const { data, error } = await this.supabase.from('user_services').update(updates).eq('user_id', userId).eq('service_id', serviceId).select().single();\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // UTILITY OPERATIONS\n    // =====================================================\n    async ensureUserExists(userId, email, name) {\n        // Try to get existing user\n        const { data: existingUser, error: getError } = await this.supabase.from('users').select('*').eq('id', userId).single();\n        if (existingUser) {\n            return existingUser;\n        }\n        // Create user if doesn't exist\n        if (email && name) {\n            const { data: newUser, error: createError } = await this.supabase.from('users').insert({\n                id: userId,\n                email,\n                name,\n                created_at: new Date().toISOString(),\n                updated_at: new Date().toISOString()\n            }).select().single();\n            if (createError) {\n                console.error('Error creating user:', createError);\n                throw createError;\n            }\n            return newUser;\n        }\n        throw new Error('User not found and insufficient data to create user');\n    }\n    constructor(){\n        this.supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://nvwrmmuyzxanjvsadtfh.supabase.co\", // Use anon key as fallback if service role key is invalid\n        process.env.SUPABASE_SERVICE_ROLE_KEY?.includes('0000000000000000000000000000000000000000') ? \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52d3JtbXV5enhhbmp2c2FkdGZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3MjgzNjQsImV4cCI6MjA3MTMwNDM2NH0.8k1x6zfO0KO9ExeDKcPP4FbaCA-BezxJWGHnNJ0VhQU\" : process.env.SUPABASE_SERVICE_ROLE_KEY);\n    }\n}\n// Export a singleton instance\nconst supabaseServerService = new SupabaseServerService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVc7WUFDcEMsR0FDQ3BDLE1BQU0sR0FDTkcsTUFBTTtZQUVULElBQUk4QixhQUFhO2dCQUNmN0IsUUFBUU4sS0FBSyxDQUFDLHdCQUF3Qm1DO2dCQUN0QyxNQUFNQTtZQUNSO1lBRUEsT0FBT0Q7UUFDVDtRQUVBLE1BQU0sSUFBSVYsTUFBTTtJQUNsQjs7YUFoS1EzQixXQUFXTCxtRUFBWUEsQ0FDN0I2QiwwQ0FBb0MsRUFDcEMsMERBQTBEO1FBQzFEQSxRQUFRQyxHQUFHLENBQUNDLHlCQUF5QixFQUFFSCxTQUFTLDhDQUM1Q0Msa05BQXlDLEdBQ3pDQSxRQUFRQyxHQUFHLENBQUNDLHlCQUF5Qjs7QUE0SjdDO0FBRUEsOEJBQThCO0FBQ3ZCLE1BQU1tQix3QkFBd0IsSUFBSWpELHdCQUF1QiIsInNvdXJjZXMiOlsiL1VzZXJzL2NhcnJpZXl1L0Rlc2t0b3Avc3BvdGlmeS9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCB0eXBlIHsgRGF0YWJhc2UgfSBmcm9tICcuL3R5cGVzJ1xuXG50eXBlIFRhYmxlcyA9IERhdGFiYXNlWydwdWJsaWMnXVsnVGFibGVzJ11cbnR5cGUgRW51bXMgPSBEYXRhYmFzZVsncHVibGljJ11bJ0VudW1zJ11cblxuLy8gVHlwZSBhbGlhc2VzIGZvciBiZXR0ZXIgcmVhZGFiaWxpdHlcbmV4cG9ydCB0eXBlIFVzZXIgPSBUYWJsZXNbJ3VzZXJzJ11bJ1JvdyddXG5leHBvcnQgdHlwZSBVc2VySW5zZXJ0ID0gVGFibGVzWyd1c2VycyddWydJbnNlcnQnXVxuZXhwb3J0IHR5cGUgVXNlclVwZGF0ZSA9IFRhYmxlc1sndXNlcnMnXVsnVXBkYXRlJ11cblxuZXhwb3J0IHR5cGUgVXNlclNlcnZpY2UgPSBUYWJsZXNbJ3VzZXJfc2VydmljZXMnXVsnUm93J11cbmV4cG9ydCB0eXBlIFVzZXJTZXJ2aWNlSW5zZXJ0ID0gVGFibGVzWyd1c2VyX3NlcnZpY2VzJ11bJ0luc2VydCddXG5leHBvcnQgdHlwZSBVc2VyU2VydmljZVVwZGF0ZSA9IFRhYmxlc1sndXNlcl9zZXJ2aWNlcyddWydVcGRhdGUnXVxuXG5leHBvcnQgdHlwZSBNdXNpY1NlcnZpY2UgPSBFbnVtc1snbXVzaWNfc2VydmljZSddXG5cbmV4cG9ydCBjbGFzcyBTdXBhYmFzZVNlcnZlclNlcnZpY2Uge1xuICBwcml2YXRlIHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgLy8gVXNlIGFub24ga2V5IGFzIGZhbGxiYWNrIGlmIHNlcnZpY2Ugcm9sZSBrZXkgaXMgaW52YWxpZFxuICAgIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVk/LmluY2x1ZGVzKCcwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwJykgXG4gICAgICA/IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIVxuICAgICAgOiBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIVxuICApXG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVVNFUiBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgZ2V0Q3VycmVudFVzZXIoKTogUHJvbWlzZTxVc2VyIHwgbnVsbD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9IH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsXG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBmcm9tIGRhdGFiYXNlOicsIGVycm9yKVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBjdXJyZW50IHVzZXI6JywgZXJyb3IpXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVVzZXIodXNlckRhdGE6IFVzZXJJbnNlcnQpOiBQcm9taXNlPFVzZXI+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLmluc2VydCh1c2VyRGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVVzZXIodXNlcklkOiBzdHJpbmcsIHVwZGF0ZXM6IFVzZXJVcGRhdGUpOiBQcm9taXNlPFVzZXI+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxuICAgICAgLmVxKCdpZCcsIHVzZXJJZClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFNFUlZJQ0UgQ09OTkVDVElPTiBPUEVSQVRJT05TIChTZXJ2ZXItc2lkZSlcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBnZXRVc2VyU2VydmljZXModXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXJTZXJ2aWNlW10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcl9zZXJ2aWNlcycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgIC5lcSgnaXNfYWN0aXZlJywgdHJ1ZSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgY29ubmVjdFNlcnZpY2Uoc2VydmljZURhdGE6IFVzZXJTZXJ2aWNlSW5zZXJ0KTogUHJvbWlzZTxVc2VyU2VydmljZT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX3NlcnZpY2VzJylcbiAgICAgICAgLnVwc2VydChzZXJ2aWNlRGF0YSwgeyBvbkNvbmZsaWN0OiAndXNlcl9pZCxzZXJ2aWNlX2lkJyB9KVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjb25uZWN0aW5nIHNlcnZpY2U6JywgZXJyb3IpXG4gICAgICAgIFxuICAgICAgICAvLyBJZiBpdCdzIGFuIFJMUyBlcnJvciBhbmQgd2UncmUgdXNpbmcgYW5vbiBrZXksIHByb3ZpZGUgaGVscGZ1bCBtZXNzYWdlXG4gICAgICAgIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcygncm93LWxldmVsIHNlY3VyaXR5JykgJiYgXG4gICAgICAgICAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZPy5pbmNsdWRlcygnMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCcpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZXJ2aWNlIHJvbGUga2V5IG5vdCBjb25maWd1cmVkLiBQbGVhc2UgdXBkYXRlIFNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgaW4geW91ciAuZW52IGZpbGUgd2l0aCB0aGUgcmVhbCBrZXkgZnJvbSBTdXBhYmFzZSBEYXNoYm9hcmQuJylcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGNvbm5lY3RTZXJ2aWNlOicsIGVycm9yKVxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gIH1cblxuICBhc3luYyBkaXNjb25uZWN0U2VydmljZSh1c2VySWQ6IHN0cmluZywgc2VydmljZUlkOiBNdXNpY1NlcnZpY2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcl9zZXJ2aWNlcycpXG4gICAgICAudXBkYXRlKHsgaXNfYWN0aXZlOiBmYWxzZSB9KVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgLmVxKCdzZXJ2aWNlX2lkJywgc2VydmljZUlkKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICB9XG5cbiAgYXN5bmMgdXBkYXRlU2VydmljZSh1c2VySWQ6IHN0cmluZywgc2VydmljZUlkOiBNdXNpY1NlcnZpY2UsIHVwZGF0ZXM6IFVzZXJTZXJ2aWNlVXBkYXRlKTogUHJvbWlzZTxVc2VyU2VydmljZT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX3NlcnZpY2VzJylcbiAgICAgIC51cGRhdGUodXBkYXRlcylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgIC5lcSgnc2VydmljZV9pZCcsIHNlcnZpY2VJZClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFVUSUxJVFkgT1BFUkFUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGFzeW5jIGVuc3VyZVVzZXJFeGlzdHModXNlcklkOiBzdHJpbmcsIGVtYWlsPzogc3RyaW5nLCBuYW1lPzogc3RyaW5nKTogUHJvbWlzZTxVc2VyPiB7XG4gICAgLy8gVHJ5IHRvIGdldCBleGlzdGluZyB1c2VyXG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1VzZXIsIGVycm9yOiBnZXRFcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdpZCcsIHVzZXJJZClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGV4aXN0aW5nVXNlcikge1xuICAgICAgcmV0dXJuIGV4aXN0aW5nVXNlclxuICAgIH1cblxuICAgIC8vIENyZWF0ZSB1c2VyIGlmIGRvZXNuJ3QgZXhpc3RcbiAgICBpZiAoZW1haWwgJiYgbmFtZSkge1xuICAgICAgY29uc3QgeyBkYXRhOiBuZXdVc2VyLCBlcnJvcjogY3JlYXRlRXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgaWQ6IHVzZXJJZCxcbiAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0pXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKClcblxuICAgICAgaWYgKGNyZWF0ZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHVzZXI6JywgY3JlYXRlRXJyb3IpXG4gICAgICAgIHRocm93IGNyZWF0ZUVycm9yXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXdVc2VyXG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCBhbmQgaW5zdWZmaWNpZW50IGRhdGEgdG8gY3JlYXRlIHVzZXInKVxuICB9XG59XG5cbi8vIEV4cG9ydCBhIHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlU2VydmVyU2VydmljZSA9IG5ldyBTdXBhYmFzZVNlcnZlclNlcnZpY2UoKVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIlN1cGFiYXNlU2VydmVyU2VydmljZSIsImdldEN1cnJlbnRVc2VyIiwiZGF0YSIsInVzZXIiLCJzdXBhYmFzZSIsImF1dGgiLCJnZXRVc2VyIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImNvbnNvbGUiLCJjcmVhdGVVc2VyIiwidXNlckRhdGEiLCJpbnNlcnQiLCJ1cGRhdGVVc2VyIiwidXNlcklkIiwidXBkYXRlcyIsInVwZGF0ZSIsImdldFVzZXJTZXJ2aWNlcyIsImNvbm5lY3RTZXJ2aWNlIiwic2VydmljZURhdGEiLCJ1cHNlcnQiLCJvbkNvbmZsaWN0IiwibWVzc2FnZSIsImluY2x1ZGVzIiwicHJvY2VzcyIsImVudiIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJFcnJvciIsImRpc2Nvbm5lY3RTZXJ2aWNlIiwic2VydmljZUlkIiwiaXNfYWN0aXZlIiwidXBkYXRlU2VydmljZSIsImVuc3VyZVVzZXJFeGlzdHMiLCJlbWFpbCIsIm5hbWUiLCJleGlzdGluZ1VzZXIiLCJnZXRFcnJvciIsIm5ld1VzZXIiLCJjcmVhdGVFcnJvciIsImNyZWF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ1cGRhdGVkX2F0IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZVNlcnZlclNlcnZpY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/service.ts":
/*!*********************************!*\
  !*** ./lib/supabase/service.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SupabaseService: () => (/* binding */ SupabaseService),\n/* harmony export */   supabaseService: () => (/* binding */ supabaseService)\n/* harmony export */ });\n/* harmony import */ var _client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./client */ \"(rsc)/./lib/supabase/client.ts\");\n\nclass SupabaseService {\n    // =====================================================\n    // USER OPERATIONS\n    // =====================================================\n    async getCurrentUser() {\n        const { data: { user } } = await this.supabase.auth.getUser();\n        if (!user) return null;\n        const { data, error } = await this.supabase.from('users').select('*').eq('id', user.id).single();\n        if (error) throw error;\n        return data;\n    }\n    async createUser(userData) {\n        const { data, error } = await this.supabase.from('users').insert(userData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async updateUser(userId, updates) {\n        const { data, error } = await this.supabase.from('users').update(updates).eq('id', userId).select().single();\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // ARTIST OPERATIONS\n    // =====================================================\n    async getArtists(limit = 50, offset = 0) {\n        const { data, error } = await this.supabase.from('artists').select('*').order('name').range(offset, offset + limit - 1);\n        if (error) throw error;\n        return data;\n    }\n    async getArtist(id) {\n        const { data, error } = await this.supabase.from('artists').select('*').eq('id', id).single();\n        if (error) throw error;\n        return data;\n    }\n    async searchArtists(query, limit = 20) {\n        const { data, error } = await this.supabase.from('artists').select('*').ilike('name', `%${query}%`).limit(limit);\n        if (error) throw error;\n        return data;\n    }\n    async createArtist(artistData) {\n        const { data, error } = await this.supabase.from('artists').insert(artistData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // ALBUM OPERATIONS\n    // =====================================================\n    async getAlbums(limit = 50, offset = 0) {\n        const { data, error } = await this.supabase.from('albums').select(`\n        *,\n        artist:artists(*)\n      `).order('release_date', {\n            ascending: false\n        }).range(offset, offset + limit - 1);\n        if (error) throw error;\n        return data;\n    }\n    async getAlbum(id) {\n        const { data, error } = await this.supabase.from('albums').select(`\n        *,\n        artist:artists(*),\n        tracks:tracks(*)\n      `).eq('id', id).single();\n        if (error) throw error;\n        return data;\n    }\n    async getAlbumsByArtist(artistId) {\n        const { data, error } = await this.supabase.from('albums').select('*').eq('artist_id', artistId).order('release_date', {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async searchAlbums(query, limit = 20) {\n        const { data, error } = await this.supabase.from('albums').select(`\n        *,\n        artist:artists(*)\n      `).ilike('title', `%${query}%`).limit(limit);\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // TRACK OPERATIONS\n    // =====================================================\n    async getTracks(limit = 50, offset = 0) {\n        const { data, error } = await this.supabase.from('tracks').select(`\n        *,\n        artist:artists(*),\n        album:albums(*)\n      `).order('title').range(offset, offset + limit - 1);\n        if (error) throw error;\n        return data;\n    }\n    async getTrack(id) {\n        const { data, error } = await this.supabase.from('tracks').select(`\n        *,\n        artist:artists(*),\n        album:albums(*),\n        track_services(*)\n      `).eq('id', id).single();\n        if (error) throw error;\n        return data;\n    }\n    async getTracksByAlbum(albumId) {\n        const { data, error } = await this.supabase.from('tracks').select(`\n        *,\n        artist:artists(*)\n      `).eq('album_id', albumId).order('track_number');\n        if (error) throw error;\n        return data;\n    }\n    async searchTracks(query, limit = 20) {\n        const { data, error } = await this.supabase.from('tracks').select(`\n        *,\n        artist:artists(*),\n        album:albums(*)\n      `).ilike('title', `%${query}%`).limit(limit);\n        if (error) throw error;\n        return data;\n    }\n    async createTrack(trackData) {\n        const { data, error } = await this.supabase.from('tracks').insert(trackData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async getTrackServices(trackId) {\n        const { data, error } = await this.supabase.from('track_services').select('*').eq('track_id', trackId).eq('is_available', true);\n        if (error) throw error;\n        return data;\n    }\n    async addTrackService(trackServiceData) {\n        const { data, error } = await this.supabase.from('track_services').insert(trackServiceData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async getBestStreamUrl(trackId, preferredQuality = 'high') {\n        const { data, error } = await this.supabase.from('track_services').select('stream_url, quality').eq('track_id', trackId).eq('is_available', true).order('quality', {\n            ascending: false\n        }).limit(1).single();\n        if (error) throw error;\n        return data?.stream_url || null;\n    }\n    // =====================================================\n    // PLAYLIST OPERATIONS\n    // =====================================================\n    async getPlaylists(limit = 50, offset = 0) {\n        const { data, error } = await this.supabase.from('playlists').select(`\n        *,\n        creator:users!creator_id(*)\n      `).eq('visibility', 'public').order('created_at', {\n            ascending: false\n        }).range(offset, offset + limit - 1);\n        if (error) throw error;\n        return data;\n    }\n    async getUserPlaylists(userId) {\n        const { data, error } = await this.supabase.from('playlists').select(`\n        *,\n        creator:users!creator_id(*)\n      `).eq('creator_id', userId).order('updated_at', {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async getPlaylist(id) {\n        const { data, error } = await this.supabase.from('playlists').select(`\n        *,\n        creator:users!creator_id(*),\n        playlist_tracks(\n          position,\n          track:tracks(\n            *,\n            artist:artists(*),\n            album:albums(*)\n          )\n        )\n      `).eq('id', id).single();\n        if (error) throw error;\n        return data;\n    }\n    async createPlaylist(playlistData) {\n        const { data, error } = await this.supabase.from('playlists').insert(playlistData).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async addTrackToPlaylist(playlistId, trackId, position) {\n        // Get the next position if not provided\n        if (!position) {\n            const { data: maxPosition } = await this.supabase.from('playlist_tracks').select('position').eq('playlist_id', playlistId).order('position', {\n                ascending: false\n            }).limit(1).single();\n            position = (maxPosition?.position || 0) + 1;\n        }\n        const { error } = await this.supabase.from('playlist_tracks').insert({\n            playlist_id: playlistId,\n            track_id: trackId,\n            position,\n            added_by: (await this.getCurrentUser())?.id || null\n        });\n        if (error) throw error;\n    }\n    // =====================================================\n    // USER LIBRARY OPERATIONS\n    // =====================================================\n    async getUserLibrary(userId) {\n        const { data, error } = await this.supabase.from('user_library').select(`\n        *,\n        track:tracks(\n          *,\n          artist:artists(*),\n          album:albums(*)\n        ),\n        album:albums(\n          *,\n          artist:artists(*)\n        ),\n        artist:artists(*),\n        playlist:playlists(\n          *,\n          creator:users!creator_id(*)\n        )\n      `).eq('user_id', userId).order('added_at', {\n            ascending: false\n        });\n        if (error) throw error;\n        return data;\n    }\n    async addToLibrary(libraryItem) {\n        const { data, error } = await this.supabase.from('user_library').insert(libraryItem).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async removeFromLibrary(userId, itemId, itemType) {\n        const { error } = await this.supabase.from('user_library').delete().eq('user_id', userId).eq(`${itemType}_id`, itemId);\n        if (error) throw error;\n    }\n    // =====================================================\n    // PLAY HISTORY OPERATIONS\n    // =====================================================\n    async addPlayHistory(historyItem) {\n        const { data, error } = await this.supabase.from('user_play_history').insert(historyItem).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async getUserPlayHistory(userId, limit = 50) {\n        const { data, error } = await this.supabase.from('user_play_history').select(`\n        *,\n        track:tracks(\n          *,\n          artist:artists(*),\n          album:albums(*)\n        )\n      `).eq('user_id', userId).order('played_at', {\n            ascending: false\n        }).limit(limit);\n        if (error) throw error;\n        return data;\n    }\n    // =====================================================\n    // SERVICE CONNECTION OPERATIONS\n    // =====================================================\n    async getUserServices(userId) {\n        const { data, error } = await this.supabase.from('user_services').select('*').eq('user_id', userId).eq('is_active', true);\n        if (error) throw error;\n        return data;\n    }\n    async connectService(serviceData) {\n        const { data, error } = await this.supabase.from('user_services').upsert(serviceData, {\n            onConflict: 'user_id,service_id'\n        }).select().single();\n        if (error) throw error;\n        return data;\n    }\n    async disconnectService(userId, serviceId) {\n        const { error } = await this.supabase.from('user_services').update({\n            is_active: false\n        }).eq('user_id', userId).eq('service_id', serviceId);\n        if (error) throw error;\n    }\n    // =====================================================\n    // SEARCH OPERATIONS\n    // =====================================================\n    async searchAll(query, limit = 20) {\n        const [tracks, albums, artists, playlists] = await Promise.all([\n            this.searchTracks(query, limit),\n            this.searchAlbums(query, limit),\n            this.searchArtists(query, limit),\n            this.searchPlaylists(query, limit)\n        ]);\n        return {\n            tracks,\n            albums,\n            artists,\n            playlists,\n            query,\n            total: tracks.length + albums.length + artists.length + playlists.length\n        };\n    }\n    async searchPlaylists(query, limit = 20) {\n        const { data, error } = await this.supabase.from('playlists').select(`\n        *,\n        creator:users!creator_id(*)\n      `).ilike('title', `%${query}%`).eq('visibility', 'public').limit(limit);\n        if (error) throw error;\n        return data;\n    }\n    constructor(){\n        this.supabase = (0,_client__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n    }\n}\n// Export a singleton instance\nconst supabaseService = new SupabaseService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCIiwic291cmNlcyI6WyIvVXNlcnMvY2FycmlleXUvRGVza3RvcC9zcG90aWZ5L2xpYi9zdXBhYmFzZS9zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJy4vY2xpZW50J1xuaW1wb3J0IHR5cGUgeyBEYXRhYmFzZSB9IGZyb20gJy4vdHlwZXMnXG5cbnR5cGUgVGFibGVzID0gRGF0YWJhc2VbJ3B1YmxpYyddWydUYWJsZXMnXVxudHlwZSBFbnVtcyA9IERhdGFiYXNlWydwdWJsaWMnXVsnRW51bXMnXVxuXG4vLyBUeXBlIGFsaWFzZXMgZm9yIGJldHRlciByZWFkYWJpbGl0eVxuZXhwb3J0IHR5cGUgVXNlciA9IFRhYmxlc1sndXNlcnMnXVsnUm93J11cbmV4cG9ydCB0eXBlIFVzZXJJbnNlcnQgPSBUYWJsZXNbJ3VzZXJzJ11bJ0luc2VydCddXG5leHBvcnQgdHlwZSBVc2VyVXBkYXRlID0gVGFibGVzWyd1c2VycyddWydVcGRhdGUnXVxuXG5leHBvcnQgdHlwZSBBcnRpc3QgPSBUYWJsZXNbJ2FydGlzdHMnXVsnUm93J11cbmV4cG9ydCB0eXBlIEFydGlzdEluc2VydCA9IFRhYmxlc1snYXJ0aXN0cyddWydJbnNlcnQnXVxuZXhwb3J0IHR5cGUgQXJ0aXN0VXBkYXRlID0gVGFibGVzWydhcnRpc3RzJ11bJ1VwZGF0ZSddXG5cbmV4cG9ydCB0eXBlIEFsYnVtID0gVGFibGVzWydhbGJ1bXMnXVsnUm93J11cbmV4cG9ydCB0eXBlIEFsYnVtSW5zZXJ0ID0gVGFibGVzWydhbGJ1bXMnXVsnSW5zZXJ0J11cbmV4cG9ydCB0eXBlIEFsYnVtVXBkYXRlID0gVGFibGVzWydhbGJ1bXMnXVsnVXBkYXRlJ11cblxuZXhwb3J0IHR5cGUgVHJhY2sgPSBUYWJsZXNbJ3RyYWNrcyddWydSb3cnXVxuZXhwb3J0IHR5cGUgVHJhY2tJbnNlcnQgPSBUYWJsZXNbJ3RyYWNrcyddWydJbnNlcnQnXVxuZXhwb3J0IHR5cGUgVHJhY2tVcGRhdGUgPSBUYWJsZXNbJ3RyYWNrcyddWydVcGRhdGUnXVxuXG5leHBvcnQgdHlwZSBUcmFja1NlcnZpY2UgPSBUYWJsZXNbJ3RyYWNrX3NlcnZpY2VzJ11bJ1JvdyddXG5leHBvcnQgdHlwZSBUcmFja1NlcnZpY2VJbnNlcnQgPSBUYWJsZXNbJ3RyYWNrX3NlcnZpY2VzJ11bJ0luc2VydCddXG5cbmV4cG9ydCB0eXBlIFBsYXlsaXN0ID0gVGFibGVzWydwbGF5bGlzdHMnXVsnUm93J11cbmV4cG9ydCB0eXBlIFBsYXlsaXN0SW5zZXJ0ID0gVGFibGVzWydwbGF5bGlzdHMnXVsnSW5zZXJ0J11cbmV4cG9ydCB0eXBlIFBsYXlsaXN0VXBkYXRlID0gVGFibGVzWydwbGF5bGlzdHMnXVsnVXBkYXRlJ11cblxuZXhwb3J0IHR5cGUgUGxheWxpc3RUcmFjayA9IFRhYmxlc1sncGxheWxpc3RfdHJhY2tzJ11bJ1JvdyddXG5leHBvcnQgdHlwZSBQbGF5bGlzdFRyYWNrSW5zZXJ0ID0gVGFibGVzWydwbGF5bGlzdF90cmFja3MnXVsnSW5zZXJ0J11cblxuZXhwb3J0IHR5cGUgVXNlckxpYnJhcnkgPSBUYWJsZXNbJ3VzZXJfbGlicmFyeSddWydSb3cnXVxuZXhwb3J0IHR5cGUgVXNlckxpYnJhcnlJbnNlcnQgPSBUYWJsZXNbJ3VzZXJfbGlicmFyeSddWydJbnNlcnQnXVxuXG5leHBvcnQgdHlwZSBVc2VyUGxheUhpc3RvcnkgPSBUYWJsZXNbJ3VzZXJfcGxheV9oaXN0b3J5J11bJ1JvdyddXG5leHBvcnQgdHlwZSBVc2VyUGxheUhpc3RvcnlJbnNlcnQgPSBUYWJsZXNbJ3VzZXJfcGxheV9oaXN0b3J5J11bJ0luc2VydCddXG5cbmV4cG9ydCB0eXBlIFVzZXJTZXJ2aWNlID0gVGFibGVzWyd1c2VyX3NlcnZpY2VzJ11bJ1JvdyddXG5leHBvcnQgdHlwZSBVc2VyU2VydmljZUluc2VydCA9IFRhYmxlc1sndXNlcl9zZXJ2aWNlcyddWydJbnNlcnQnXVxuZXhwb3J0IHR5cGUgVXNlclNlcnZpY2VVcGRhdGUgPSBUYWJsZXNbJ3VzZXJfc2VydmljZXMnXVsnVXBkYXRlJ11cblxuZXhwb3J0IHR5cGUgTXVzaWNTZXJ2aWNlID0gRW51bXNbJ211c2ljX3NlcnZpY2UnXVxuZXhwb3J0IHR5cGUgVHJhY2tRdWFsaXR5ID0gRW51bXNbJ3RyYWNrX3F1YWxpdHknXVxuZXhwb3J0IHR5cGUgQWxidW1UeXBlID0gRW51bXNbJ2FsYnVtX3R5cGUnXVxuZXhwb3J0IHR5cGUgUGxheWxpc3RWaXNpYmlsaXR5ID0gRW51bXNbJ3BsYXlsaXN0X3Zpc2liaWxpdHknXVxuZXhwb3J0IHR5cGUgU3Vic2NyaXB0aW9uVGllciA9IEVudW1zWydzdWJzY3JpcHRpb25fdGllciddXG5cbmV4cG9ydCBjbGFzcyBTdXBhYmFzZVNlcnZpY2Uge1xuICBwcml2YXRlIHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KClcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBVU0VSIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBnZXRDdXJyZW50VXNlcigpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZS5hdXRoLmdldFVzZXIoKVxuICAgIGlmICghdXNlcikgcmV0dXJuIG51bGxcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCB1c2VyLmlkKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVVzZXIodXNlckRhdGE6IFVzZXJJbnNlcnQpOiBQcm9taXNlPFVzZXI+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLmluc2VydCh1c2VyRGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVVzZXIodXNlcklkOiBzdHJpbmcsIHVwZGF0ZXM6IFVzZXJVcGRhdGUpOiBQcm9taXNlPFVzZXI+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxuICAgICAgLmVxKCdpZCcsIHVzZXJJZClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEFSVElTVCBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgZ2V0QXJ0aXN0cyhsaW1pdCA9IDUwLCBvZmZzZXQgPSAwKTogUHJvbWlzZTxBcnRpc3RbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhcnRpc3RzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLm9yZGVyKCduYW1lJylcbiAgICAgIC5yYW5nZShvZmZzZXQsIG9mZnNldCArIGxpbWl0IC0gMSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgZ2V0QXJ0aXN0KGlkOiBzdHJpbmcpOiBQcm9taXNlPEFydGlzdCB8IG51bGw+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnYXJ0aXN0cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBzZWFyY2hBcnRpc3RzKHF1ZXJ5OiBzdHJpbmcsIGxpbWl0ID0gMjApOiBQcm9taXNlPEFydGlzdFtdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ2FydGlzdHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuaWxpa2UoJ25hbWUnLCBgJSR7cXVlcnl9JWApXG4gICAgICAubGltaXQobGltaXQpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUFydGlzdChhcnRpc3REYXRhOiBBcnRpc3RJbnNlcnQpOiBQcm9taXNlPEFydGlzdD4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhcnRpc3RzJylcbiAgICAgIC5pbnNlcnQoYXJ0aXN0RGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEFMQlVNIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBnZXRBbGJ1bXMobGltaXQgPSA1MCwgb2Zmc2V0ID0gMCk6IFByb21pc2U8QWxidW1bXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhbGJ1bXMnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGFydGlzdDphcnRpc3RzKCopXG4gICAgICBgKVxuICAgICAgLm9yZGVyKCdyZWxlYXNlX2RhdGUnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgIC5yYW5nZShvZmZzZXQsIG9mZnNldCArIGxpbWl0IC0gMSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgZ2V0QWxidW0oaWQ6IHN0cmluZyk6IFByb21pc2U8QWxidW0gfCBudWxsPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ2FsYnVtcycpXG4gICAgICAuc2VsZWN0KGBcbiAgICAgICAgKixcbiAgICAgICAgYXJ0aXN0OmFydGlzdHMoKiksXG4gICAgICAgIHRyYWNrczp0cmFja3MoKilcbiAgICAgIGApXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgZ2V0QWxidW1zQnlBcnRpc3QoYXJ0aXN0SWQ6IHN0cmluZyk6IFByb21pc2U8QWxidW1bXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhbGJ1bXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2FydGlzdF9pZCcsIGFydGlzdElkKVxuICAgICAgLm9yZGVyKCdyZWxlYXNlX2RhdGUnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgc2VhcmNoQWxidW1zKHF1ZXJ5OiBzdHJpbmcsIGxpbWl0ID0gMjApOiBQcm9taXNlPEFsYnVtW10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgnYWxidW1zJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKVxuICAgICAgYClcbiAgICAgIC5pbGlrZSgndGl0bGUnLCBgJSR7cXVlcnl9JWApXG4gICAgICAubGltaXQobGltaXQpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFRSQUNLIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBnZXRUcmFja3MobGltaXQgPSA1MCwgb2Zmc2V0ID0gMCk6IFByb21pc2U8VHJhY2tbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0cmFja3MnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGFydGlzdDphcnRpc3RzKCopLFxuICAgICAgICBhbGJ1bTphbGJ1bXMoKilcbiAgICAgIGApXG4gICAgICAub3JkZXIoJ3RpdGxlJylcbiAgICAgIC5yYW5nZShvZmZzZXQsIG9mZnNldCArIGxpbWl0IC0gMSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgZ2V0VHJhY2soaWQ6IHN0cmluZyk6IFByb21pc2U8VHJhY2sgfCBudWxsPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3RyYWNrcycpXG4gICAgICAuc2VsZWN0KGBcbiAgICAgICAgKixcbiAgICAgICAgYXJ0aXN0OmFydGlzdHMoKiksXG4gICAgICAgIGFsYnVtOmFsYnVtcygqKSxcbiAgICAgICAgdHJhY2tfc2VydmljZXMoKilcbiAgICAgIGApXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgZ2V0VHJhY2tzQnlBbGJ1bShhbGJ1bUlkOiBzdHJpbmcpOiBQcm9taXNlPFRyYWNrW10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndHJhY2tzJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKVxuICAgICAgYClcbiAgICAgIC5lcSgnYWxidW1faWQnLCBhbGJ1bUlkKVxuICAgICAgLm9yZGVyKCd0cmFja19udW1iZXInKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBzZWFyY2hUcmFja3MocXVlcnk6IHN0cmluZywgbGltaXQgPSAyMCk6IFByb21pc2U8VHJhY2tbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0cmFja3MnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGFydGlzdDphcnRpc3RzKCopLFxuICAgICAgICBhbGJ1bTphbGJ1bXMoKilcbiAgICAgIGApXG4gICAgICAuaWxpa2UoJ3RpdGxlJywgYCUke3F1ZXJ5fSVgKVxuICAgICAgLmxpbWl0KGxpbWl0KVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBjcmVhdGVUcmFjayh0cmFja0RhdGE6IFRyYWNrSW5zZXJ0KTogUHJvbWlzZTxUcmFjaz4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0cmFja3MnKVxuICAgICAgLmluc2VydCh0cmFja0RhdGEpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBnZXRUcmFja1NlcnZpY2VzKHRyYWNrSWQ6IHN0cmluZyk6IFByb21pc2U8VHJhY2tTZXJ2aWNlW10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndHJhY2tfc2VydmljZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3RyYWNrX2lkJywgdHJhY2tJZClcbiAgICAgIC5lcSgnaXNfYXZhaWxhYmxlJywgdHJ1ZSlcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgYWRkVHJhY2tTZXJ2aWNlKHRyYWNrU2VydmljZURhdGE6IFRyYWNrU2VydmljZUluc2VydCk6IFByb21pc2U8VHJhY2tTZXJ2aWNlPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3RyYWNrX3NlcnZpY2VzJylcbiAgICAgIC5pbnNlcnQodHJhY2tTZXJ2aWNlRGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGdldEJlc3RTdHJlYW1VcmwodHJhY2tJZDogc3RyaW5nLCBwcmVmZXJyZWRRdWFsaXR5OiBUcmFja1F1YWxpdHkgPSAnaGlnaCcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndHJhY2tfc2VydmljZXMnKVxuICAgICAgLnNlbGVjdCgnc3RyZWFtX3VybCwgcXVhbGl0eScpXG4gICAgICAuZXEoJ3RyYWNrX2lkJywgdHJhY2tJZClcbiAgICAgIC5lcSgnaXNfYXZhaWxhYmxlJywgdHJ1ZSlcbiAgICAgIC5vcmRlcigncXVhbGl0eScsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgLmxpbWl0KDEpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YT8uc3RyZWFtX3VybCB8fCBudWxsXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBQTEFZTElTVCBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgZ2V0UGxheWxpc3RzKGxpbWl0ID0gNTAsIG9mZnNldCA9IDApOiBQcm9taXNlPFBsYXlsaXN0W10+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgncGxheWxpc3RzJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICBjcmVhdG9yOnVzZXJzIWNyZWF0b3JfaWQoKilcbiAgICAgIGApXG4gICAgICAuZXEoJ3Zpc2liaWxpdHknLCAncHVibGljJylcbiAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgLnJhbmdlKG9mZnNldCwgb2Zmc2V0ICsgbGltaXQgLSAxKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBnZXRVc2VyUGxheWxpc3RzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxQbGF5bGlzdFtdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXlsaXN0cycpXG4gICAgICAuc2VsZWN0KGBcbiAgICAgICAgKixcbiAgICAgICAgY3JlYXRvcjp1c2VycyFjcmVhdG9yX2lkKCopXG4gICAgICBgKVxuICAgICAgLmVxKCdjcmVhdG9yX2lkJywgdXNlcklkKVxuICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGdldFBsYXlsaXN0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFBsYXlsaXN0IHwgbnVsbD4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdwbGF5bGlzdHMnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGNyZWF0b3I6dXNlcnMhY3JlYXRvcl9pZCgqKSxcbiAgICAgICAgcGxheWxpc3RfdHJhY2tzKFxuICAgICAgICAgIHBvc2l0aW9uLFxuICAgICAgICAgIHRyYWNrOnRyYWNrcyhcbiAgICAgICAgICAgICosXG4gICAgICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKSxcbiAgICAgICAgICAgIGFsYnVtOmFsYnVtcygqKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgYClcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBjcmVhdGVQbGF5bGlzdChwbGF5bGlzdERhdGE6IFBsYXlsaXN0SW5zZXJ0KTogUHJvbWlzZTxQbGF5bGlzdD4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdwbGF5bGlzdHMnKVxuICAgICAgLmluc2VydChwbGF5bGlzdERhdGEpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBhZGRUcmFja1RvUGxheWxpc3QocGxheWxpc3RJZDogc3RyaW5nLCB0cmFja0lkOiBzdHJpbmcsIHBvc2l0aW9uPzogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gR2V0IHRoZSBuZXh0IHBvc2l0aW9uIGlmIG5vdCBwcm92aWRlZFxuICAgIGlmICghcG9zaXRpb24pIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogbWF4UG9zaXRpb24gfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3BsYXlsaXN0X3RyYWNrcycpXG4gICAgICAgIC5zZWxlY3QoJ3Bvc2l0aW9uJylcbiAgICAgICAgLmVxKCdwbGF5bGlzdF9pZCcsIHBsYXlsaXN0SWQpXG4gICAgICAgIC5vcmRlcigncG9zaXRpb24nLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgLmxpbWl0KDEpXG4gICAgICAgIC5zaW5nbGUoKVxuXG4gICAgICBwb3NpdGlvbiA9IChtYXhQb3NpdGlvbj8ucG9zaXRpb24gfHwgMCkgKyAxXG4gICAgfVxuXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3BsYXlsaXN0X3RyYWNrcycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgcGxheWxpc3RfaWQ6IHBsYXlsaXN0SWQsXG4gICAgICAgIHRyYWNrX2lkOiB0cmFja0lkLFxuICAgICAgICBwb3NpdGlvbixcbiAgICAgICAgYWRkZWRfYnk6IChhd2FpdCB0aGlzLmdldEN1cnJlbnRVc2VyKCkpPy5pZCB8fCBudWxsXG4gICAgICB9KVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gVVNFUiBMSUJSQVJZIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBnZXRVc2VyTGlicmFyeSh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8VXNlckxpYnJhcnlbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX2xpYnJhcnknKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIHRyYWNrOnRyYWNrcyhcbiAgICAgICAgICAqLFxuICAgICAgICAgIGFydGlzdDphcnRpc3RzKCopLFxuICAgICAgICAgIGFsYnVtOmFsYnVtcygqKVxuICAgICAgICApLFxuICAgICAgICBhbGJ1bTphbGJ1bXMoXG4gICAgICAgICAgKixcbiAgICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKVxuICAgICAgICApLFxuICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKSxcbiAgICAgICAgcGxheWxpc3Q6cGxheWxpc3RzKFxuICAgICAgICAgICosXG4gICAgICAgICAgY3JlYXRvcjp1c2VycyFjcmVhdG9yX2lkKCopXG4gICAgICAgIClcbiAgICAgIGApXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAub3JkZXIoJ2FkZGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGFkZFRvTGlicmFyeShsaWJyYXJ5SXRlbTogVXNlckxpYnJhcnlJbnNlcnQpOiBQcm9taXNlPFVzZXJMaWJyYXJ5PiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfbGlicmFyeScpXG4gICAgICAuaW5zZXJ0KGxpYnJhcnlJdGVtKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG5cbiAgYXN5bmMgcmVtb3ZlRnJvbUxpYnJhcnkodXNlcklkOiBzdHJpbmcsIGl0ZW1JZDogc3RyaW5nLCBpdGVtVHlwZTogJ3RyYWNrJyB8ICdhbGJ1bScgfCAnYXJ0aXN0JyB8ICdwbGF5bGlzdCcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcl9saWJyYXJ5JylcbiAgICAgIC5kZWxldGUoKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgLmVxKGAke2l0ZW1UeXBlfV9pZGAsIGl0ZW1JZClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFBMQVkgSElTVE9SWSBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgYWRkUGxheUhpc3RvcnkoaGlzdG9yeUl0ZW06IFVzZXJQbGF5SGlzdG9yeUluc2VydCk6IFByb21pc2U8VXNlclBsYXlIaXN0b3J5PiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfcGxheV9oaXN0b3J5JylcbiAgICAgIC5pbnNlcnQoaGlzdG9yeUl0ZW0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBnZXRVc2VyUGxheUhpc3RvcnkodXNlcklkOiBzdHJpbmcsIGxpbWl0ID0gNTApOiBQcm9taXNlPFVzZXJQbGF5SGlzdG9yeVtdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfcGxheV9oaXN0b3J5JylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICB0cmFjazp0cmFja3MoXG4gICAgICAgICAgKixcbiAgICAgICAgICBhcnRpc3Q6YXJ0aXN0cygqKSxcbiAgICAgICAgICBhbGJ1bTphbGJ1bXMoKilcbiAgICAgICAgKVxuICAgICAgYClcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgIC5vcmRlcigncGxheWVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAubGltaXQobGltaXQpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIFNFUlZJQ0UgQ09OTkVDVElPTiBPUEVSQVRJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgYXN5bmMgZ2V0VXNlclNlcnZpY2VzKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyU2VydmljZVtdPiB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5zdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfc2VydmljZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAuZXEoJ2lzX2FjdGl2ZScsIHRydWUpXG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gICAgcmV0dXJuIGRhdGFcbiAgfVxuXG4gIGFzeW5jIGNvbm5lY3RTZXJ2aWNlKHNlcnZpY2VEYXRhOiBVc2VyU2VydmljZUluc2VydCk6IFByb21pc2U8VXNlclNlcnZpY2U+IHtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcl9zZXJ2aWNlcycpXG4gICAgICAudXBzZXJ0KHNlcnZpY2VEYXRhLCB7IG9uQ29uZmxpY3Q6ICd1c2VyX2lkLHNlcnZpY2VfaWQnIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICAgIHJldHVybiBkYXRhXG4gIH1cblxuICBhc3luYyBkaXNjb25uZWN0U2VydmljZSh1c2VySWQ6IHN0cmluZywgc2VydmljZUlkOiBNdXNpY1NlcnZpY2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCB0aGlzLnN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcl9zZXJ2aWNlcycpXG4gICAgICAudXBkYXRlKHsgaXNfYWN0aXZlOiBmYWxzZSB9KVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgLmVxKCdzZXJ2aWNlX2lkJywgc2VydmljZUlkKVxuXG4gICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gU0VBUkNIIE9QRVJBVElPTlNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBhc3luYyBzZWFyY2hBbGwocXVlcnk6IHN0cmluZywgbGltaXQgPSAyMCkge1xuICAgIGNvbnN0IFt0cmFja3MsIGFsYnVtcywgYXJ0aXN0cywgcGxheWxpc3RzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuc2VhcmNoVHJhY2tzKHF1ZXJ5LCBsaW1pdCksXG4gICAgICB0aGlzLnNlYXJjaEFsYnVtcyhxdWVyeSwgbGltaXQpLFxuICAgICAgdGhpcy5zZWFyY2hBcnRpc3RzKHF1ZXJ5LCBsaW1pdCksXG4gICAgICB0aGlzLnNlYXJjaFBsYXlsaXN0cyhxdWVyeSwgbGltaXQpXG4gICAgXSlcblxuICAgIHJldHVybiB7XG4gICAgICB0cmFja3MsXG4gICAgICBhbGJ1bXMsXG4gICAgICBhcnRpc3RzLFxuICAgICAgcGxheWxpc3RzLFxuICAgICAgcXVlcnksXG4gICAgICB0b3RhbDogdHJhY2tzLmxlbmd0aCArIGFsYnVtcy5sZW5ndGggKyBhcnRpc3RzLmxlbmd0aCArIHBsYXlsaXN0cy5sZW5ndGhcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZWFyY2hQbGF5bGlzdHMocXVlcnk6IHN0cmluZywgbGltaXQgPSAyMCk6IFByb21pc2U8UGxheWxpc3RbXT4ge1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMuc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdwbGF5bGlzdHMnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGNyZWF0b3I6dXNlcnMhY3JlYXRvcl9pZCgqKVxuICAgICAgYClcbiAgICAgIC5pbGlrZSgndGl0bGUnLCBgJSR7cXVlcnl9JWApXG4gICAgICAuZXEoJ3Zpc2liaWxpdHknLCAncHVibGljJylcbiAgICAgIC5saW1pdChsaW1pdClcblxuICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcbiAgICByZXR1cm4gZGF0YVxuICB9XG59XG5cbi8vIEV4cG9ydCBhIHNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlU2VydmljZSA9IG5ldyBTdXBhYmFzZVNlcnZpY2UoKVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIlN1cGFiYXNlU2VydmljZSIsImdldEN1cnJlbnRVc2VyIiwiZGF0YSIsInVzZXIiLCJzdXBhYmFzZSIsImF1dGgiLCJnZXRVc2VyIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsImluc2VydCIsInVwZGF0ZVVzZXIiLCJ1c2VySWQiLCJ1cGRhdGVzIiwidXBkYXRlIiwiZ2V0QXJ0aXN0cyIsImxpbWl0Iiwib2Zmc2V0Iiwib3JkZXIiLCJyYW5nZSIsImdldEFydGlzdCIsInNlYXJjaEFydGlzdHMiLCJxdWVyeSIsImlsaWtlIiwiY3JlYXRlQXJ0aXN0IiwiYXJ0aXN0RGF0YSIsImdldEFsYnVtcyIsImFzY2VuZGluZyIsImdldEFsYnVtIiwiZ2V0QWxidW1zQnlBcnRpc3QiLCJhcnRpc3RJZCIsInNlYXJjaEFsYnVtcyIsImdldFRyYWNrcyIsImdldFRyYWNrIiwiZ2V0VHJhY2tzQnlBbGJ1bSIsImFsYnVtSWQiLCJzZWFyY2hUcmFja3MiLCJjcmVhdGVUcmFjayIsInRyYWNrRGF0YSIsImdldFRyYWNrU2VydmljZXMiLCJ0cmFja0lkIiwiYWRkVHJhY2tTZXJ2aWNlIiwidHJhY2tTZXJ2aWNlRGF0YSIsImdldEJlc3RTdHJlYW1VcmwiLCJwcmVmZXJyZWRRdWFsaXR5Iiwic3RyZWFtX3VybCIsImdldFBsYXlsaXN0cyIsImdldFVzZXJQbGF5bGlzdHMiLCJnZXRQbGF5bGlzdCIsImNyZWF0ZVBsYXlsaXN0IiwicGxheWxpc3REYXRhIiwiYWRkVHJhY2tUb1BsYXlsaXN0IiwicGxheWxpc3RJZCIsInBvc2l0aW9uIiwibWF4UG9zaXRpb24iLCJwbGF5bGlzdF9pZCIsInRyYWNrX2lkIiwiYWRkZWRfYnkiLCJnZXRVc2VyTGlicmFyeSIsImFkZFRvTGlicmFyeSIsImxpYnJhcnlJdGVtIiwicmVtb3ZlRnJvbUxpYnJhcnkiLCJpdGVtSWQiLCJpdGVtVHlwZSIsImRlbGV0ZSIsImFkZFBsYXlIaXN0b3J5IiwiaGlzdG9yeUl0ZW0iLCJnZXRVc2VyUGxheUhpc3RvcnkiLCJnZXRVc2VyU2VydmljZXMiLCJjb25uZWN0U2VydmljZSIsInNlcnZpY2VEYXRhIiwidXBzZXJ0Iiwib25Db25mbGljdCIsImRpc2Nvbm5lY3RTZXJ2aWNlIiwic2VydmljZUlkIiwiaXNfYWN0aXZlIiwic2VhcmNoQWxsIiwidHJhY2tzIiwiYWxidW1zIiwiYXJ0aXN0cyIsInBsYXlsaXN0cyIsIlByb21pc2UiLCJhbGwiLCJzZWFyY2hQbGF5bGlzdHMiLCJ0b3RhbCIsImxlbmd0aCIsInN1cGFiYXNlU2VydmljZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/service.ts\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&page=%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute.ts&appDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&page=%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute.ts&appDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _Users_carrieyu_Desktop_spotify_app_api_auth_spotify_callback_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./app/api/auth/spotify/callback/route.ts */ \"(rsc)/./app/api/auth/spotify/callback/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/spotify/callback/route\",\n        pathname: \"/api/auth/spotify/callback\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/spotify/callback/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/Users/carrieyu/Desktop/spotify/app/api/auth/spotify/callback/route.ts\",\n    nextConfigOutput,\n    userland: _Users_carrieyu_Desktop_spotify_app_api_auth_spotify_callback_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/auth/spotify/callback/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGc3BvdGlmeSUyRmNhbGxiYWNrJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdXRoJTJGc3BvdGlmeSUyRmNhbGxiYWNrJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYXV0aCUyRnNwb3RpZnklMkZjYWxsYmFjayUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmNhcnJpZXl1JTJGRGVza3RvcCUyRnNwb3RpZnklMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGY2FycmlleXUlMkZEZXNrdG9wJTJGc3BvdGlmeSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCZpc0dsb2JhbE5vdEZvdW5kRW5hYmxlZD0hIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2Q7QUFDUztBQUNPO0FBQ0s7QUFDbUM7QUFDakQ7QUFDTztBQUNmO0FBQ3NDO0FBQ3pCO0FBQ007QUFDQztBQUNoQjtBQUNpQztBQUNuRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCx3QkFBd0IsTUFBdUM7QUFDL0Q7QUFDQTtBQUNBLFlB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RTtBQUNBLGtCQUFrQiw2RUFBWTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTjtBQUNBLDRDQUE0Qyw2RkFBZTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2NhcnJpZXl1L0Rlc2t0b3Avc3BvdGlmeS9hcHAvYXBpL2F1dGgvc3BvdGlmeS9jYWxsYmFjay9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9zcG90aWZ5L2NhbGxiYWNrL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9zcG90aWZ5L2NhbGxiYWNrXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdXRoL3Nwb3RpZnkvY2FsbGJhY2svcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2NhcnJpZXl1L0Rlc2t0b3Avc3BvdGlmeS9hcHAvYXBpL2F1dGgvc3BvdGlmeS9jYWxsYmFjay9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2F1dGgvc3BvdGlmeS9jYWxsYmFjay9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IHdyYXBwZWQgYnkgYmFzZS1zZXJ2ZXIgaGFuZGxlIGhlcmVcbiAgICAgICAgaWYgKCFhY3RpdmVTcGFuICYmICEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&page=%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute.ts&appDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "?d272":
/*!********************************!*\
  !*** supports-color (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/superagent","vendor-chunks/mime-db","vendor-chunks/spotify-web-api-node","vendor-chunks/mime","vendor-chunks/qs","vendor-chunks/formidable","vendor-chunks/object-inspect","vendor-chunks/debug","vendor-chunks/get-intrinsic","vendor-chunks/form-data","vendor-chunks/cookiejar","vendor-chunks/asynckit","vendor-chunks/fast-safe-stringify","vendor-chunks/combined-stream","vendor-chunks/mime-types","vendor-chunks/side-channel-list","vendor-chunks/ms","vendor-chunks/side-channel-weakmap","vendor-chunks/has-symbols","vendor-chunks/delayed-stream","vendor-chunks/function-bind","vendor-chunks/side-channel-map","vendor-chunks/es-set-tostringtag","vendor-chunks/side-channel","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/methods","vendor-chunks/dunder-proto","vendor-chunks/math-intrinsics","vendor-chunks/call-bound","vendor-chunks/es-errors","vendor-chunks/gopd","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&page=%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fspotify%2Fcallback%2Froute.ts&appDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fcarrieyu%2FDesktop%2Fspotify&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();